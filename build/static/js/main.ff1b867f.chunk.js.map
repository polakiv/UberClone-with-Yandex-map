{"version":3,"sources":["scalePage.js","reducer.js","StateProvider.js","SidebarChat.js","tablets.png","YourRole.js","notification.mp3","DropdownMenu.js","toastInfo.js","DialogCustom.js","DrawerLeft.js","firebase.js","Sidebar.js","MediaPreview.js","ImagePreview.js","recorder.js","ChatFooter.js","AudioPlayer.js","message_sent.mp3","message_received.mp3","Chat.js","Login.js","useFetchData.js","UberTypes.js","DestinationSearch.js","App.js","useRoomsData.js","setOnlineStatus.js","serviceWorkerRegistration.js","index.js"],"names":["scalePage","window","innerHeight","innerWidth","currentRatio","ratio","width","height","transform","initialState","user","path","pathID","dispatchMessages","audioID","roomsData","page","actionTypes","SET_USER","SET_MESSAGES","reducer","state","action","type","id","update","messages","length","limitReached","firstMessageID","audio","undefined","arr","s","isSame","i","slice","newMessages","f","updatedMessages","roomID","e","findIndex","cur","data","newRoomsData","lastMessageListener","onlineStatelistener","dataType","StateContext","createContext","StateProvider","children","Provider","value","useReducer","useStateValue","useContext","SidebarChat","dataList","title","fetchList","dispatch","useState","scrollFetch","setScrollFetch","list","setList","sidebarChatContainer","useRef","useEffect","a","parseInt","current","scrollTop","scrollHeight","offsetHeight","addEventListener","clean","removeEventListener","setTimeout","Array","from","document","querySelectorAll","forEach","classList","remove","onlineState","lastMessage","push","className","to","pathname","photoURL","name","about","phone","userID","Avatar","style","src","dangerouslySetInnerHTML","__html","_highlightResult","marginBottom","message","Photo","MicRounded","time","unreadMessages","ref","CircularProgress","SearchOutlined","CancelOutlined","memo","YourRole","localStorage","getItem","open","setOpen","role","setRole","handleYourRoleOpen","cursor","onClick","Tablet","alt","maxWidth","paddingTop","Dialog","DialogTitle","DialogContent","DialogActions","justifyContent","Button","preventDefault","setItem","color","DropdownMenu","menuLists","menu","handleMenuClose","Menu","anchorEl","keepMounted","Boolean","onClose","anchorOrigin","vertical","horizontal","transformOrigin","getContentAnchorEl","map","menuList","MenuItem","toastInfo","toastTitle","toastId","position","toast","info","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","DialogCustom","close","photo","fullScreen","IconButton","edge","Zoom","in","transitionDelay","useStyles","makeStyles","theme","root","display","drawerPaper","DrawerLeft","drawerLeft","setDrawerLeft","db","auth","storage","classes","setName","setAbout","setPhone","showEditName","setShowEditName","showEditAbout","setShowEditAbout","showEditPhone","setShowEditPhone","showProfilePhoto","setShowProfilePhoto","uploadPhotoLink","setUploadPhotoLink","showDialogUpload","setShowDialogUpload","menuProfile","setMenuProfile","setPhoto","displayName","collection","doc","uid","onSnapshot","onFileChangeImage","file","target","files","size","storageRef","isAnonymous","imagesRef","child","fileRef","put","getDownloadURL","console","log","handleUploadPhoto","currentUser","updateProfile","set","merge","Math","random","htmlFor","onChange","accept","Drawer","anchor","variant","paper","event","currentTarget","styles","borderBottom","then","catch","error","firebaseApp","firebase","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","firestore","db2","database","provider","GoogleAuthProvider","createTimestamp","FieldValue","serverTimestamp","createTimestamp2","ServerValue","TIMESTAMP","messaging","navigator","fieldIncrement","increment","arrayUnion","storage1","audioStorage","Sidebar","Nav","chats","pwa","rooms","fetchRooms","users","fetchUsers","usersSearch","fetchUsersSearch","setSearchList","searchListy","setSearchListy","searchRole","setSearchRole","searchInput","setSearchInput","setMenu","mounted","setMounted","history","useHistory","notification","Audio","prevUnreadMessages","querySelector","blur","filtered","filter","element","index","array","toLowerCase","indexOf","props","classSelected","click","NavLink","filteredRole","searchrole","play","add","prompt","GetAppRounded","placeholder","activeClassName","Home","PeopleAlt","DriveEta","imageSRC","mediaPreview","setHeight","imagePreview","animState","loaded","setLoaded","animW","animH","el","imageRatio","imgH","imgW","backgroundColor","borderRadius","left","top","imgStyle","minWidth","minHeight","createPortal","toggle","goBack","onLoad","record","Promise","resolve","mediaDevices","getUserMedia","stream","mediaRecorder","MediaRecorder","audioChunks","start","stop","audioName","uuidv4","audioFile","File","audioUrl","URL","createObjectURL","wait","input","handleFocus","change","sendMessage","setFocus","image","focus","token","setAudioID","recording","setRecording","recordingTimer","setRecordingTimer","recordingEl","inputRef","timerInterval","sendAudio","timer","seen","timestamp","Date","toUTCString","audioPlayed","url","body","onLine","recorder","alert","stopRecording","clearInterval","stopped","opacity","pad","val","valString","now","setInterval","delta","totalSeconds","floor","btnIcons","CSSTransition","timeout","enter","exit","classNames","Send","onBlur","contains","relatedTarget","onKeyPress","onFocus","for","capture","duration","CancelRounded","CheckCircleRounded","sender","isPlaying","setIsPlaying","mediaLoaded","setMediaLoaded","metadataLoaded","setMetadataLoaded","setError","sliderValue","setSliderValue","sliderPlayedWidth","setSliderPlayedWidth","setDuration","totalDuration","interval","uploading","seekUpdate","seekPosition","isNaN","currentTime","currentMinutes","currentSeconds","getCurrentTime","load","media","reject","onloadedmetadata","Number","MAX_SAFE_INTEGER","ontimeupdate","durationMinutes","durationSeconds","pause","min","max","seekto","Chat","b","setInput","useParams","location","useLocation","match","useRouteMatch","setImagePreview","setMessages","openMenu","setOpenMenu","deleting","setDeleting","setToken","setState","setSeen","typing","setTyping","setSRC","setImage","writeState","setWriteState","setRatio","scrollArrow","setScrollArrow","clientWidth","setClientWidth","firstRender","setFirstRender","sendAnim","setSendAnim","setLimitReached","chatBodyRef","lastMessageRef","chatBodyContainer","chatAnim","prevMessages","limit","prevScrollHeight","paginating","paginating2","paginateLoader","setPaginateLoader","messageSentAudio","audio2","messageReceivedAudio","audio1","mediaSnap","mediaChecked","animation","outerHeight","getComputedStyle","marginTop","inputText","imageToUpload","roomInfo","split","imageName","messageToSend","toLocaleString","year","month","day","weekday","timezone","hour","minute","imageUrl","Compressor","quality","success","result","deleteRoom","room","get","fetchedMessages","fetchedAudios","fecthedImages","docs","usersChats","Set","all","delete","img","aud","userChat","replace","fetchMessages","orderBy","snapshot","toDate","reverse","paginate","listenToImg","docID","snap","listenToAudio","useLayoutEffect","nodeArr","lastMHeight","node","anime","targets","easing","complete","scrollChatBody","x","init","empty","clientHeight","h","z","round","widthRatio","reader","FileReader","onload","readAsDataURL","AddPhotoAlternate","MoreVert","Delete","signOut","reload","VisibilityOff","messageArr","parentNode","obj","getBoundingClientRect","offsetWidth","clickImagePreview","appear","DoneAllRounded","clearTimeout","unmountOnExit","ArrowDownward","TransitionGroup","component","Transition","Login","signInWithRedirect","useFetchData","limitNumber","initCount","snapHandler","dataUnsub","setData","snapCount","fetchData","getData","spacing","options","suppressMapOpenBlock","geolocation","getCurrentPosition","lat","coords","latitude","lng","longitude","gps","accuracy","lati","lngi","gpsi","mapState","center","zoom","DestinationSearch","setMap","setMapOpen","setMapf","setMapOpenf","React","carsfire","query","apikey","modules","onApiAvaliable","ymaps","instanceRef","routePanel","getRouteAsync","multiRoute","model","events","activeRoute","getActiveRoute","getPaths","each","segments","getSegments","obje","segment","properties","text","distance","bind","float","popupWidth","rotate","geometry","coordinates","hintContent","balloonContent","iconCaption","iconImageRotation","car","iconLayout","iconImageHref","iconImageSize","iconImageOffset","padding","margin","alignItems","disabled","gpska","gps_suma","App","loader","setLoader","pwaEvent","setPwaEvent","updating","openMap","setChats","chatsFetched","setChatsFetched","initRoomsData","onlineStateListener","useRoomsData","setRoomsData","menus","where","onAuthStateChanged","authUser","requestPermission","getToken","includeMetadataChanges","docChanges","metadata","fromCache","every","substring","isOfflineForDatabase","last_changed","coord","coord_sum","isOnlineForDatabase","userStatusFirestoreRef","userStatusDatabaseRef","isOfflineForFirestore","isOnlineForFirestore","on","onDisconnect","setOnlineStatus","find","isLocalhost","hostname","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","constraints","webkitGetUserMedia","mozGetUserMedia","call","Error","ReactDOM","render","StrictMode","getElementById","process","href","origin","fetch","headers","response","contentType","status","ready","unregister","checkValidServiceWorker","serviceWorkerRegistration"],"mappings":"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","file":"static/js/main.ff1b867f.chunk.js","sourcesContent":["export default function scalePage() {\n    if (window.innerHeight > 768 && window.innerWidth > 1366) {\n        const currentRatio = window.innerHeight / window.innerWidth;\n        const ratio = 768 / 1366;\n        if (ratio < currentRatio) {\n            return {\n                width: 1366,\n                height: window.innerHeight * (1366 / window.innerWidth),\n                transform: `scale(${window.innerWidth / 1366})`\n            };\n        } else if (ratio > currentRatio) {\n            return {\n                width: window.innerWidth * (768 / window.innerHeight),\n                height: 768,\n                transform: `scale(${window.innerHeight / 768})`\n            };\n        } else {\n            return {\n                width: 1366,\n                height: 768,\n                transform: `scale(${window.innerHeight / 768})`\n            };\n        };\n    };\n    return {\n        width: window.innerWidth,\n        height: window.innerHeight,\n        transform: `scale(1)`\n    };\n};","import scalePage from \"./scalePage\";\n\nexport const initialState = {\n    user: null,\n    path: \"\",\n    pathID: \"\",\n    dispatchMessages: {},\n    audioID: null,\n    roomsData: {},\n    page: scalePage()\n}\n\nexport const  actionTypes = {\n    SET_USER: \"SET_USER\",\n    SET_MESSAGES : \"SET_MESSAGES\",\n}\n\nconst reducer = (state, action) => {\n    //console.log(action)\n    switch (action.type) {\n        case \"set_scale_page\" :\n            return {\n                ...state,\n                page: action.page\n            }\n        case actionTypes.SET_USER :\n            return {\n                ...state,\n                user: action.user\n            }\n        case \"SET_PATH\" :\n            return {\n                ...state,\n                path: action.path\n            }\n        case \"set_path_id\" :\n            return {\n                ...state,\n                pathID: action.id\n            }\n        case actionTypes.SET_MESSAGES :\n            const dispatchMessages = state.dispatchMessages;\n            //console.log(\"dispatch messages: \", dispatchMessages[action.id]);\n            //console.log(\"action messages: \", action.messages);\n            if (action.update) {\n                //console.log(\"updating\");\n                if (dispatchMessages[action.id].messages) {\n                    //console.log(\"messages exist\")\n                    if (dispatchMessages[action.id].messages.length === 0) {\n                        //console.log(\"messages length is 0\");\n                        if (action.messages.length > 0) {\n                            //console.log(\"action messages length greater than 0\");\n                            dispatchMessages[action.id] = {\n                                messages: action.messages, \n                                limitReached: dispatchMessages[action.id].limitReached,\n                                firstMessageID: dispatchMessages[action.id].firstMessageID,\n                                audio: state.pathID === action.id,\n                            };\n                        }  \n                    } else if (dispatchMessages[action.id].messages.length > 0 && action.messages.length === 0) {\n                        //console.log(\"messages were deleted\");\n                        dispatchMessages[action.id] = {\n                            messages: [], \n                            limitReached: true,\n                            firstMessageID: undefined,\n                            audio: false,\n                        };\n                    } else {\n                        const s = dispatchMessages[action.id].messages.length - action.messages.length;\n                        var isSame = s === 0 ? false : true;\n                        if (s >= 0) {\n                            //console.log(\"difference greater or equal than 0\");\n                            for (var i = 0; i < action.messages.length - 2; i++) {\n                                //console.log(\"iterating at: \", i);\n                                //console.log(\"action message: \", action.messages[i]);\n                                //console.log(\"dispatch message: \", dispatchMessages[action.id].messages[s + i + 1]);\n                                isSame = action.messages[i].id === dispatchMessages[action.id].messages[s + i + 1].id;\n                                if (!isSame) {\n                                    //console.log(\"it's not the same\");\n                                    break;\n                                }\n                            }\n                        } else {\n                            //console.log(\"difference is less than 0\");\n                            for (i = 0; i < dispatchMessages[action.id].messages.length - 2; i++) {\n                                isSame = action.messages[i].id === dispatchMessages[action.id].messages[i].id;\n                                if (!isSame) {\n                                    //console.log(\"it's not the same\");\n                                    break;\n                                };\n                            };\n                        };\n                        if (isSame) {\n                            //console.log(\"it's the same\");\n                            //console.log(\"last action message: \", action.messages[action.messages.length - 1]);\n                            //console.log(\"s: \", s);\n                            var arr;\n                            if (s >= 0) {\n                                //console.log(\"sliced: \", dispatchMessages[action.id].messages.slice(0, s + 1));\n                                arr = [...dispatchMessages[action.id].messages.slice(0, s + 1), ...action.messages];\n                            } else {\n                                //console.log(\"sliced: \", dispatchMessages[action.id].messages.slice(0, -s + 1));\n                                arr = [...action.messages]; \n                            }\n                            dispatchMessages[action.id] = {\n                                messages: arr, \n                                limitReached: dispatchMessages[action.id].limitReached,\n                                firstMessageID: dispatchMessages[action.id].firstMessageID,\n                                audio: state.pathID === action.id && isSame,\n                            };\n                        };\n                    };\n                };\n                //console.log(\"returned dispatchMessages from updating: \", dispatchMessages[action.id]);\n                return {\n                    ...state,\n                    dispatchMessages,\n                };\n            };\n            //console.log(\"not updating\");\n            dispatchMessages[action.id] = {\n                messages: action.messages, \n                limitReached: dispatchMessages[action.id].firstMessageID === \"no id\" ? true : action.messages[0]?.id === dispatchMessages[action.id].firstMessageID,\n                firstMessageID: dispatchMessages[action.id].firstMessageID,\n                audio: false\n            }\n            return {\n                ...state,\n                dispatchMessages\n            }\n        case \"set_audio_false\" : \n            const newMessages = state.dispatchMessages;\n            newMessages[action.id] = {\n                ...newMessages[action.id],\n                audio: false\n            };\n            return {\n                ...state,\n                dispatchMessages: newMessages\n            };\n        case \"set_firstMessage\" :\n            const s = state.dispatchMessages;\n            if (s[action.id]) {\n                s[action.id].firstMessageID = action.firstMessageID;\n            } else {\n                s[action.id] = {\n                    firstMessageID: action.firstMessageID\n                };\n            };\n            return {\n                ...state,\n                dispatchMessages: s\n            };\n        case \"update_media\" :\n            const f = state.dispatchMessages;\n            const updatedMessages = f[action.roomID].messages;\n            const e = updatedMessages.findIndex(cur => cur.id === action.id);\n            updatedMessages[e] = {\n                ...updatedMessages[e],\n                ...action.data\n            };\n            //console.log(\"updated media: \", f[action.roomID]);\n            f[action.roomID] = {\n                messages: updatedMessages, \n                limitReached: f[action.roomID].limitReached,\n                firstMessageID: f[action.roomID].firstMessageID\n            }\n            return {\n                ...state,\n                dispatchMessages: f,\n            }\n        case \"add_rooms_data\" :\n            const newRoomsData = {...state.roomsData};\n            //console.log(\"rooms data: \", state.roomsData);\n            newRoomsData[action.roomID] = {\n                lastMessageListener: action.lastMessageListener,\n                onlineStatelistener: action.onlineStatelistener,\n                roomID: action.roomID\n            }\n            return {\n                ...state,\n                roomsData: newRoomsData\n            }\n        case \"update_rooms_data\" :\n            const roomsData = {...state.roomsData};\n            //console.log(\"rooms data: \", state.roomsData);\n            if (action.data !== roomsData[action.roomID][action.dataType]) {\n                roomsData[action.roomID] = {\n                    ...roomsData[action.roomID],\n                    [action.dataType] : action.data\n                }\n                return {\n                    ...state,\n                    roomsData: roomsData\n                }\n            }\n            return state;\n        default: \n            return state;\n    }\n}\n\nexport default reducer;","import {createContext, useReducer, useContext} from \"react\";\nimport { actionTypes } from './reducer'\n\nexport const StateContext = createContext();\n\nexport const StateProvider = ({ reducer, initialState, children}) => (\n    <StateContext.Provider value={[...useReducer(reducer, initialState), actionTypes]}>\n        {children}\n    </StateContext.Provider>\n);\n\nexport const useStateValue = () => useContext(StateContext);","import {useEffect,  memo, useRef, useState} from 'react';\nimport { Avatar } from '@material-ui/core';\nimport { CancelOutlined, SearchOutlined, Photo, MicRounded } from '@material-ui/icons';\nimport './SidebarChat.css';\nimport { Link } from 'react-router-dom';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { useStateValue } from './StateProvider';\n//window\nfunction SidebarChat({ dataList, title, path, fetchList}) {\n    const [{roomsData, page, pathID}, dispatch] = useStateValue();\n    const [scrollFetch, setScrollFetch] = useState(false);\n    const [list, setList] = useState(null);\n    const sidebarChatContainer = useRef();\n\n    useEffect(() => {\n        var a = null;\n        if (fetchList) {\n            a = function () {\n                if (parseInt(sidebarChatContainer.current.scrollTop) === sidebarChatContainer.current.scrollHeight - sidebarChatContainer.current.offsetHeight) {\n                    fetchList(setScrollFetch);\n                };\n            };\n            if (dataList?.length > 0) {\n                sidebarChatContainer.current.addEventListener(\"scroll\", a);\n            };\n        };\n        const clean = sidebarChatContainer.current;\n        return () => {\n            if (a) {\n                //console.log(\"removing event\");\n                clean.removeEventListener(\"scroll\", a);\n                \n            };\n        };\n    }, [dataList, fetchList]);\n    \n    useEffect(() => {\n        //console.log(dataList);\n        //console.log(list)\n        if (dataList?.length === list?.length) {\n            setTimeout(() => {\n                Array.from(document.querySelectorAll('.animate')).forEach((cur,i) => {\n                    setTimeout(() => {\n                        cur.classList.remove(\"animate\");\n                    }, 50 * i);\n                });\n            }, 10);\n        };\n    }, [dataList, list]);\n\n    useEffect(() => {\n        if (dataList) {\n            const arr = [];\n            dataList.forEach(data => {\n           //     console.log(\"data: \", data);\n          //      console.log(\"rooms data: \", roomsData[data.id]);\n                if (data) {\n                    const onlineState = roomsData[data.id]?.onlineState ? roomsData[data.id].onlineState : data.state;\n                    const lastMessage = title === \"Search Result\" ? null : roomsData[data.id]?.lastMessage ? roomsData[data.id].lastMessage : data.lastMessage;\n                    if (title === \"Rooms\" || title === \"Search Result\" || title === \"Chats\" && roomsData[data.id].lastMessage || title !== \"Chats\" && roomsData[data.id]) {\n                        arr.push(<Link className=\"link\" key={data.id} to={{\n                            pathname: path ? `${path}/room/${data.id}` : `/room/${data.id}`,\n                            state: {\n                                photoURL: `${data.photoURL ? data.photoURL : `https://avatars.dicebear.com/api/human/${data.id}.svg`}`,\n                                name: data.name,\n                                about: data.about,\n                                phone: data.phone,\n                                userID: data.userID ? data.userID : null,\n                                state: data.state\n                            }\n                        }} >\n                            <div \n                                className={`sidebar__chat animate`}\n                            >\n                              {/*  <p > sidebarchat.js animate</p>*/}\n                                <div className=\"avatar__container\">\n                                    <Avatar style={{width: 45,height: 45}} src={`${data.photoURL ? data.photoURL : `https://avatars.dicebear.com/api/human/${data.id}.svg`}`} />\n                                    {onlineState=== \"online\" ? <div className=\"online\"></div> : null}\n                                </div>\n                                <div className=\"sidebar__chat--info\">\n                                    <h2 \n                                        dangerouslySetInnerHTML={{__html: title === \"Результат поиска\" ? data._highlightResult.name.value : data.name}}\n                                        style={{\n                                            width: page.width <= 760 ? page.width - 126 : page.width * 0.315 - 126,\n                                            marginBottom: lastMessage?.message || lastMessage ? 8 : 0,\n                                        }}\n                                    ></h2>\n                                    <p style={{width: page.width <= 760 ? page.width - 126 : page.width * 0.315 - 126}}\n                                    dangerouslySetInnerHTML={{__html:  data.about}}\n                                    >\n                                    </p>\n                                    <p style={{width: page.width <= 760 ? page.width - 126 : page.width * 0.315 - 126}}\n                                   \n                                    >\n                                        {lastMessage?.message ? \n                                            <><Photo style={{width: 19,height: 19}} /> <span style={{width: page.width <= 160 ? page.width - 150 : page.width * 0.315 - 150}}>{lastMessage.message}</span> </>\n                                            : lastMessage?.audio ?\n                                            <><MicRounded style={{width: 19,height: 19}} /><span style={{width: page.width <= 160 ? page.width - 150 : page.width * 0.315 - 150}}>{lastMessage.time}</span></>\n                                            : lastMessage?.message === \"\" ?\n                                            <><Photo style={{width: 19,height: 19}} /> <span style={{width: page.width <= 160 ? page.width - 150 : page.width * 0.315 - 150}}>Photo</span> </>\n                                        :lastMessage}\n                                    </p>\n                                </div>\n                                {data?.unreadMessages && pathID !== data.id ?\n                                    <div className=\"sidebar__chat--unreadMessages\">\n                                        <div>\n                                            {data.unreadMessages}\n                                        </div>\n                                    </div>\n                                :null}\n                            </div>\n                        </Link>);\n                    }\n                } else {\n                    arr.push(null);\n                }\n            });\n            setList(arr)\n        }\n    }, [dataList, roomsData, page, pathID]);\n\n    useEffect(() => {\n        if (page.width <= 160) {\n            dispatch({type: \"SET_PATH\", path: path});\n        } else {\n            dispatch({type: \"SET_PATH\", path: \"\"})\n        }\n    }, [path, page]);\n\n    return (\n        <div ref={sidebarChatContainer} className=\"sidebar__chat--container\">\n            {/* <p>SidebarChat.js</p>*/}\n            <h2 className=\"animate\">{title} </h2>\n            {dataList?.length > 0 ? list : dataList === null && title !== \"Chats\" ?\n                <div className=\"loader__container sidebar__loader\">\n                    <CircularProgress />\n                </div>\n                :\n                <div className=\"no-result\">\n                    <div>\n                        <SearchOutlined />\n                        <div className=\"cancel-root\">\n                            <CancelOutlined />\n                        </div>\n                    </div>\n                    <h2> {title} не найдено </h2>\n                </div>\n                \n            }\n            <div className=\"loader__container scrollFetch\">\n                {scrollFetch ? <CircularProgress /> : null}\n            </div>\n        </div>\n    )\n}\n\nexport default memo(SidebarChat);\n","export default __webpack_public_path__ + \"static/media/tablets.13043575.png\";","import React, { useState } from \"react\";\n//import TooltipCustom from '../shared/TooltipCustom';\n// import db from '../firebase';\nimport Button from \"@material-ui/core/Button\";\n// import TextField from '@material-ui/core/TextField';\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\n//import ChatIcon from '@material-ui/icons/Chat';\nimport Tablet from \"../src/tablets.png\";\n\nfunction YourRole() {\n  const [open, setOpen] = useState(\n    !localStorage.getItem(\"role\") ? true : false\n  );\n  const [role, setRole] = useState(localStorage.getItem(\"role\"));\n\n  const handleYourRoleOpen = () => {\n    setOpen(true);\n  };\n\n  const handleYourRoleClose = () => {\n    setOpen(false);\n    //  setRoomName(\"\");\n  };\n\n  const createYourRoleRider = (e) => {\n    e.preventDefault();\n    localStorage.setItem(\"role\", \"Пассажир\");\n    localStorage.setItem(\"searchrole\", \"Водитель\");\n    setOpen(false);\n    setRole(\"Пассажир\");\n  };\n\n  const createYourRoleDriver = (e) => {\n    e.preventDefault();\n    localStorage.setItem(\"role\", \"Водитель\");\n    localStorage.setItem(\"searchrole\", \"Пассажир\");\n    setOpen(false);\n    setRole(\"Водитель\");\n  };\n\n  return (\n    <div>\n      {/*}  <TooltipCustom \n                name=\"New YourRole\" \n                onClick={() => handleYourRoleOpen()} \n                icon={<ChatIcon />}\n            />*/}\n      <span style={{ cursor: \"pointer\" }} onClick={() => handleYourRoleOpen()}>\n        <img\n          src={Tablet}\n          alt=\"YouLrole\"\n          style={{ maxWidth: 40, paddingTop: 20, cursor: \"pointer\" }}\n          onClick={() => handleYourRoleOpen()}\n        />\n        {role}\n      </span>\n      <Dialog open={open} aria-labelledby=\"form-dialog-title\">\n        <DialogTitle id=\"form-dialog-title\">\n          Выберите кто вы сегодня:{\" \"}\n        </DialogTitle>\n        <DialogContent>\n          {/* <TextField\n                        autoFocus\n                        margin=\"dense\"\n                        id=\"name\"\n                        label=\"Room Name\"\n                        type=\"text\"\n                        fullWidth\n                        value={roomName}\n                        onChange={e => setRoomName(e.target.value)}\n                   />*/}\n          <img src={Tablet} alt=\"YouLrole\" style={{ maxWidth: \"100%\" }} />\n        </DialogContent>\n        <DialogActions style={{ justifyContent: \"space-around\" }}>\n          <Button onClick={createYourRoleDriver} color=\"primary\">\n            Водитель\n          </Button>\n          <Button onClick={createYourRoleRider} color=\"primary\">\n            Пассажир\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n}\n\nexport default YourRole;\n","export default __webpack_public_path__ + \"static/media/notification.34e1d6f8.mp3\";","import React from 'react';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nfunction DropdownMenu ( { menuLists, menu, handleMenuClose }) {\n    return (\n        <div>\n      {/*  <p style={{fontSize:'10px'}}> DropdownMenu.js</p>*/}\n            <Menu id=\"simple-menu\"\n                anchorEl={menu}\n                keepMounted\n                open={Boolean(menu)}\n                onClose={handleMenuClose}\n                anchorOrigin={{\n                    vertical: \"bottom\",\n                    horizontal: \"right\"\n                }}\n                transformOrigin={{\n                    vertical: \"top\",\n                    horizontal: \"right\"\n                }}\n                getContentAnchorEl={null}\n                >\n                \n                {menuLists.map((menuList) =>\n                    <MenuItem key={menuList.id} onClick={menuList.onClick}>\n                        {menuList.title}\n                    </MenuItem> \n                )}\n            </Menu>\n        </div>\n    )\n}\n\nexport default DropdownMenu","import { toast } from 'react-toastify';\n\nexport const toastInfo = ( toastTitle, toastId, position ) => {\n    toast.info(toastTitle, {\n        toastId: toastId,\n        position: position,\n        autoClose: 5000,\n        hideProgressBar: true,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true,\n        progress: undefined,\n        }\n    );\n}","import React from 'react';\n// import ReactPlayer from 'react-player';\n//importing material-ui\nimport Zoom from '@material-ui/core/Zoom';\nimport Avatar from '@material-ui/core/Avatar';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport IconButton from '@material-ui/core/IconButton';\n//importing material-ui-icons\nimport CloseIcon from '@material-ui/icons/Close';\n//importing styles\nimport './DialogCustom.css'\n\nfunction DialogCustom({ open, close, user, photo }) {\n    \n    return (\n        <Dialog\n            open={open}\n            fullScreen \n            onClose={close}\n            aria-labelledby=\"alert-dialog-title\"\n            aria-describedby=\"alert-dialog-description\"\n            >\n                \n         {/*   <p style={{fontSize:'10px'}}> DialogCustom.js</p>*/}\n            <DialogTitle id=\"alert-dialog-title-dialogCustom\">\n                <div>\n                    <Avatar src={user.photoURL}/>\n                </div>\n                <div>\n                    <IconButton edge=\"end\" color=\"inherit\" onClick={close} aria-label=\"close\">\n                        <CloseIcon />\n                    </IconButton>\n                </div>\n            </DialogTitle>\n            <DialogContent>\n                <Zoom in={open} style={{ transitionDelay: open ? '300ms' : '0ms' }}>\n                    <img src={photo} alt=\"\" className=\"DialogCustom__photo\"/>\n                </Zoom>\n            </DialogContent>\n        </Dialog>\n    )\n}\n\nexport default DialogCustom\n","import React, { useEffect, useState } from \"react\";\nimport { useStateValue } from \"./StateProvider\";\n//importing components\nimport DropdownMenu from \"./DropdownMenu\";\nimport { toastInfo } from \"./toastInfo\";\nimport DialogCustom from \"./DialogCustom\";\n//importing material-ui\nimport Zoom from \"@material-ui/core/Zoom\";\nimport Drawer from \"@material-ui/core/Drawer\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport { makeStyles } from \"@material-ui/core/styles\";\n//importing material-ui-icons\nimport PhotoCameraIcon from \"@material-ui/icons/PhotoCamera\";\nimport ArrowBackIcon from \"@material-ui/icons/ArrowBack\";\nimport EditIcon from \"@material-ui/icons/Edit\";\nimport CheckIcon from \"@material-ui/icons/Check\";\n//importing styles\nimport \"./DrawerLeft.css\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: \"flex\",\n  },\n  drawerPaper: {\n    position: \"absolute\",\n  },\n}));\n\nfunction DrawerLeft({ drawerLeft, setDrawerLeft, db, auth, storage }) {\n  const classes = useStyles();\n  const [{ user }] = useStateValue();\n  const [name, setName] = useState(\"\");\n  const [about, setAbout] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [showEditName, setShowEditName] = useState(false);\n  const [showEditAbout, setShowEditAbout] = useState(false);\n  const [showEditPhone, setShowEditPhone] = useState(false);\n  const [showProfilePhoto, setShowProfilePhoto] = useState(false);\n  const [uploadPhotoLink, setUploadPhotoLink] = useState(null);\n  const [showDialogUpload, setShowDialogUpload] = useState(false);\n  const [menuProfile, setMenuProfile] = useState(null);\n  const [photo, setPhoto] = useState(\"\");\n\n  useEffect(() => {\n    setName(user.displayName);\n\n    db.collection(\"users\")\n      .doc(user.uid)\n      .onSnapshot(function (doc) {\n        setPhoto(doc.data()?.photoURL);\n        setAbout(doc.data()?.about);\n        setPhone(doc.data()?.phone);\n      });\n  }, [user.uid, user.displayName, db]);\n\n  const updateName = (e) => {\n    e.preventDefault();\n\n    if (user.uid) {\n      db.collection(\"users\")\n        .doc(user.uid)\n        .update({\n          name: name,\n        })\n        .then(function () {\n          console.log(\"Обновлено!\");\n        })\n        .catch(function (error) {\n          // The document probably doesn't exist.\n          console.error(\"Не удалось обновить: \", error);\n        });\n\n      auth.currentUser.updateProfile({\n        displayName: name,\n      });\n    }\n    setShowEditName(false);\n  };\n\n  const updateAbout = (e) => {\n    e.preventDefault();\n\n    if (user.uid) {\n      db.collection(\"users\") \n        .doc(user.uid)\n        .update({\n          about: about,\n        })\n        .then(function () {\n          console.log(\"Обновлено!\");\n        })\n        .catch(function (error) {\n          // The document probably doesn't exist.\n          console.error(\"Не получилось обновить: \", error);\n        });\n    }\n    setShowEditAbout(false);\n  };\n\n  const updatePhone = (e) => {\n    e.preventDefault();\n\n    if (user.uid) {\n      db.collection(\"users\") \n        .doc(user.uid)\n        .update({\n          phone: phone,\n        })\n        .then(function () {\n          console.log(\"Обновлено phone!\");\n        })\n        .catch(function (error) {\n          // The document probably doesn't exist.\n          console.error(\"Не получилось обновить phone: \", error);\n        });\n    }\n    setShowEditPhone(false);\n  };\n\n  const editName = () => {\n    setShowEditName(true);\n  };\n\n  const editAbout = () => {\n    setShowEditAbout(true);\n  };\n\n  const editPhone = () => {\n    setShowEditPhone(true);\n  };\n\n  const handleDrawerClose = () => {\n    setDrawerLeft(false);\n    setShowEditName(false);\n    setShowEditAbout(false);\n    setShowEditPhone(false);\n  };\n\n  const viewPhoto = () => {\n    const viewPhoto = \"viewPhoto\";\n\n    if (user) {\n      setShowProfilePhoto(true);\n    } else {\n      toastInfo(\"Нет фото!\", viewPhoto, \"top-center\");\n    }\n    setMenuProfile(null);\n  };\n\n  const viewPhotoClose = () => {\n    setShowProfilePhoto(false);\n  };\n\n  const takePhoto = () => {\n    const takePhoto = \"takePhoto\";\n    toastInfo(\"Выбранное фото больше недоступно!\", takePhoto, \"top-center\");\n  };\n\n  const removedPhoto = () => {\n    const removedPhoto = \"removedPhoto\";\n    toastInfo(\n      \"Удаленное фото больше не доступно!\",\n      removedPhoto,\n      \"top-center\"\n    );\n  };\n\n  const onFileChangeImage = async (e) => {\n    const imageFileSizeToastId = \"imageFileSizeToastId\";\n    const file = e.target.files[0];\n\n    if (file.size > 3 * 1024 * 1024) {\n      toastInfo(\n        \"Фотка не должна быть больше 3Mb\",\n        imageFileSizeToastId,\n        \"top-center\"\n      );\n    } else {\n      const storageRef = storage.ref();\n      if (user.isAnonymous === true) {\n        const imagesRef = storageRef.child(`user/anonymous/${user.uid}`);\n        const fileRef = imagesRef.child(file.name);\n        await fileRef.put(file);\n        setUploadPhotoLink(await fileRef.getDownloadURL());\n        console.log(\"uploading image\", uploadPhotoLink);\n      } else {\n        const imagesRef = storageRef.child(`user/regular/${user.uid}`);\n        const fileRef = imagesRef.child(file.name);\n        await fileRef.put(file);\n        setUploadPhotoLink(await fileRef.getDownloadURL());\n        console.log(\"uploading image\", uploadPhotoLink);\n      }\n    }\n    setMenuProfile(null);\n    setShowDialogUpload(true);\n  };\n\n  const uploadPhoto = () => {\n    return (\n      <div className=\"profileMenu_uploadPhoto\">\n\n    {/*    <span style={{fontSize:'10px'}}> uploadPhoto.js</span>*/}\n        <label htmlFor=\"file-input\">Загрузить фото</label>\n        <input\n          id=\"file-input\"\n          type=\"file\"\n          onChange={onFileChangeImage}\n          accept=\"image/*\"\n        />\n      </div>\n    );\n  };\n\n  const handleUploadPhoto = () => {\n    const uploadPhotoError = \"uploadPhotoError\";\n\n    if (uploadPhotoLink) {\n      auth.currentUser.updateProfile({\n        photoURL: uploadPhotoLink,\n      });\n      db.collection(\"rooms\").doc(user.uid).set(\n        {\n          photoURL: uploadPhotoLink,\n        },\n        { merge: true }\n      );\n      setShowDialogUpload(false);\n    } else {\n      toastInfo(\"Select photo to upload!\", uploadPhotoError, \"top-center\");\n    }\n  };\n\n  const handleDialogUploadClose = () => {\n    setShowDialogUpload(false);\n  };\n\n  const handleProfileMenu = (event) => {\n    setMenuProfile(event.currentTarget);\n  };\n\n  const handleProfileMenuClose = () => {\n    setMenuProfile(null);\n  };\n\n  const menuLists = [\n    {\n      title: \"Увеличить\",\n      onClick: () => viewPhoto(),\n      id: Math.random() * 100000,\n    },\n   // {\n     // title: \"Take photo\",\n     // onClick: () => takePhoto(),\n      //id: Math.random() * 100000,\n    //},\n    {\n      title: uploadPhoto(),\n      onClick: () => handleUploadPhoto(),\n      id: Math.random() * 100000,\n    },\n   /* {\n      title: \"Removed photo\",\n      onClick: () => removedPhoto(),\n      id: Math.random() * 100000,\n    },*/\n  ];\n\n  return ( \n    <div>\n      {/*<span style={{fontSize:'10px'}}> Drawer-DrawerLeft.js</span>*/}\n      <Drawer\n        anchor=\"left\"\n        variant=\"persistent\"\n        open={drawerLeft}\n        classes={{ paper: classes.drawerPaper }}\n      >\n        <div className=\"drawerLeft__header\">\n          <div className=\"drawerLeft__header_container\">\n            <IconButton onClick={handleDrawerClose}>\n              <ArrowBackIcon />\n            </IconButton>\n            <p>Ваш профиль и ваша заявка</p>\n          </div>\n        </div>\n\n        <div className=\"drawerLeft__content\">\n          <div className=\"drawerLeft__content_photo\">\n            <div className=\"profilePhoto\">\n              <Zoom\n                in={drawerLeft}\n                style={{ transitionDelay: drawerLeft ? \"300ms\" : \"0ms\" }}\n              >\n                {photo ? (\n                  <Avatar src={photo} className=\"profilePhoto__layer_bottom\" />\n                ) : (\n                  <Avatar />\n                )}\n              </Zoom>\n              <div\n                className=\"profilePhoto__layer_top\"\n                onClick={handleProfileMenu}\n              >\n                <div className=\"profilePhoto__text\">\n                  <PhotoCameraIcon />\n                  <p>Изменить</p>\n                  <p>Фото</p>\n                </div>\n              </div>\n            </div> \n\n            <DropdownMenu\n              menuLists={menuLists}\n              menu={menuProfile}\n              handleMenuClose={handleProfileMenuClose}\n            />\n\n            <DialogCustom\n              open={showProfilePhoto}\n              close={viewPhotoClose}\n              photo={photo}\n              user={user} \n            />\n          </div>\n\n          <div className=\"profileMenu__diaglog\">\n            <Dialog\n              open={showDialogUpload}\n              onClose={handleDialogUploadClose}\n              aria-labelledby=\"form-dialog-title\"\n            >\n              <DialogTitle id=\"form-dialog-title-drawerLeft\">\n                Загрузить фото(если вы водитель, то можно фото машины)\n              </DialogTitle>\n              <DialogContent id=\"form-dialog-content\">\n                <div className=\"profileMenu__uploadPhoto_dialog\">\n                  <img src={uploadPhotoLink} alt=\"\" />\n                </div>\n              </DialogContent>\n              <DialogActions>\n                <div className=\"profileMenu_uploadPhoto_iconButton\">\n                  <IconButton onClick={handleUploadPhoto}>\n                    <CheckIcon />\n                  </IconButton>\n                </div>\n              </DialogActions>\n            </Dialog>\n          </div>\n\n          <div className=\"drawerLeft__content_name\">\n            <p>Ваше имя и предложение\n            {  localStorage.getItem(\"role\") == 'Водитель' ? (\n                 <span className=\"span_namer\">Например Вася, езжу каждый день в Макеевку, в 10 утра</span> \n            ):(\n              <span className=\"span_namer\">Например Аня, пассажир, езжу каждый день в центр Донецка с Текстильщика в 8 утра, кто подвезет?</span> \n            )\n\n            }\n            </p> \n            <form>\n              {showEditName ? (\n                <>\n                  <input\n                    value={name}\n                    onChange={(e) => setName(e.target.value)}\n                    type=\"text\"\n                    styles={{ borderBottom: \"1px solid green !important\" }}\n                    \n                  />\n                  <CheckIcon onClick={updateName} />\n                </>\n              ) : (\n                <>\n                  <span>{name}</span>\n                  <EditIcon onClick={editName} />\n                </>\n              )}\n            </form>\n          </div>\n\n          <div className=\"drawerLeft__note\">\n            <span>\n             Напишите имя и оставьте свое предложение\n            </span>\n          </div>\n\n          <div className=\"drawerLeft__content_name\">\n            <p>Телефон</p>\n            <form>\n              {showEditPhone ? (\n                <>\n                  <input\n                    value={phone}\n                    onChange={(e) => setPhone(e.target.value)}\n                    type=\"text\"\n                  />\n                  <CheckIcon onClick={updatePhone} />\n                </>\n              ) : (\n                <>\n                  <span>{phone}</span>\n                  <EditIcon onClick={editPhone} />\n                </>\n              )}\n            </form>\n          </div>\n          <div className=\"drawerLeft__content_name\">\n            <p>Обо мне</p>\n            <form>\n              {showEditAbout ? (\n                <>\n                  <input\n                    value={about}\n                    onChange={(e) => setAbout(e.target.value)}\n                    type=\"text\"\n                  />\n                  <CheckIcon onClick={updateAbout} />\n                </>\n              ) : (\n                <>\n                  <span>{about}</span>\n                  <EditIcon onClick={editAbout} />\n                </>\n              )}\n            </form>\n          </div>\n        </div>\n      </Drawer>\n    </div>\n  );\n}\n\nexport default DrawerLeft;\n","import firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport \"firebase/firestore\";\nimport \"firebase/database\"\nimport \"firebase/messaging\";\nimport \"firebase/storage\"\n\nconst firebaseConfig = { \n\napiKey: \"AIzaSyBEEA2tvNgeHIYxDRJgkxDfZIBguDnybPc\",\n  authDomain: \"whatsapp2-a5f92.firebaseapp.com\",\n  databaseURL: \"https://whatsapp2-a5f92-default-rtdb.firebaseio.com\",\n  projectId: \"whatsapp2-a5f92\",\n  storageBucket: \"whatsapp2-a5f92.appspot.com\",\n  messagingSenderId: \"1023177696506\",\n  appId: \"1:1023177696506:web:a180739d1dd334d1f7d543\",\n  measurementId: \"G-XG4H351X5E\"\n};/*use your own configuration*/ \n\nconst firebaseApp = firebase.initializeApp(firebaseConfig);\n/*you can enable persistence to allow the user to see previous data when he's offline but it will make your queries very slow which leads\nto bad user experience so I suggest you implement your own offline support by caching the data and retrieving them when the user is offline*/\n//firebaseApp.firestore().enablePersistence();\nconst db = firebaseApp.firestore();\nconst db2 = firebaseApp.database();\nconst auth = firebaseApp.auth();\nconst provider = new firebase.auth.GoogleAuthProvider();\nconst createTimestamp = firebase.firestore.FieldValue.serverTimestamp;\nconst createTimestamp2 = firebase.database.ServerValue.TIMESTAMP;\nconst messaging = \"serviceWorker\" in navigator && \"PushManager\" in window ?  firebase.messaging() : null;\nconst fieldIncrement = firebase.firestore.FieldValue.increment;\nconst arrayUnion = firebase.firestore.FieldValue.arrayUnion;\nconst storage = firebase.storage().ref(\"images\");\n\nconst storage1 = firebase.storage();\nconst audioStorage = firebase.storage().ref(\"audios\");\n\n//db.disableNetwork();\n\nexport { auth , provider, createTimestamp, messaging, fieldIncrement, arrayUnion, storage, storage1, audioStorage, db2, createTimestamp2};\nexport default db;\n","import { useEffect, useState, memo, useRef } from \"react\";\nimport SidebarChat from \"./SidebarChat\";\nimport { Avatar, IconButton } from \"@material-ui/core\";\n\nimport YourRole from \"./YourRole\";\nimport {\n  Message,\n  PeopleAlt,\n  Home,\n  ExitToApp as LogOut,\n  SearchOutlined,\n  GetAppRounded,\n  Add,\n  DriveEta,\n} from \"@material-ui/icons\";\nimport { useStateValue } from \"./StateProvider\";\nimport { NavLink, Route, useHistory, Switch } from \"react-router-dom\";\n//import algoliasearch from \"algoliasearch\";\nimport \"./App.css\";\nimport audio from \"./notification.mp3\";\nimport DrawerLeft from \"./DrawerLeft\";\nimport db, {\n  auth,\n  storage1,\n  provider,\n  createTimestamp,\n  messaging,\n} from \"./firebase\";\nimport firebase from \"firebase/app\";\n\n/*\nconst index = algoliasearch(\n  \"3NMH9UCFLC\",\n  \"deb2bbef10859ca91461463cd6730232\"\n).initIndex(\"muizzchats\");\n*/\nfunction Sidebar({\n  chats,\n  pwa,\n  rooms,\n  fetchRooms,\n  users,\n  fetchUsers,\n  usersSearch,\n  fetchUsersSearch,\n}) {\n  const [drawerLeft, setDrawerLeft] = useState(false);\n  const [menuSidebar, setMenuSidebar] = useState(null);\n\n  const [searchList, setSearchList] = useState(null);\n  const [searchListy, setSearchListy] = useState(null);\n  const [searchRole, setSearchRole] = useState(null);\n\n  const [searchInput, setSearchInput] = useState(\"\");\n  const [menu, setMenu] = useState(1);\n  const [mounted, setMounted] = useState(false);\n  const [{ user, page, pathID }] = useStateValue();\n  let history = useHistory();\n  const notification = new Audio(audio);\n  const prevUnreadMessages = useRef(\n    (() => {\n      const data = {};\n      chats.forEach((cur) =>\n        cur.unreadMessages || cur.unreadMessages === 0\n          ? (data[cur.id] = cur.unreadMessages)\n          : null\n      );\n      return data;\n    })()\n  );\n\n  var Nav;\n  if (page.width > 160) {\n    Nav = (props) => (\n      <div\n        className={`${props.classSelected ? \"sidebar__menu--selected\" : \"\"}`}\n        onClick={props.click}\n      >\n        {props.children}\n      </div>\n    );\n  } else {\n    Nav = NavLink;\n  }\n\n  var filtered;\n  async function search(e) {\n    if (e) {\n      document.querySelector(\".sidebar__search input\").blur();\n      e.preventDefault();\n    }\n    if (page.width <= 160) {\n      history.push(\"/search?\" + searchInput);\n    }\n    setSearchList(null);\n    if (menu !== 4) {\n      setMenu(4);\n    }\n    // console.log(searchInput);\n    //   console.log(users);\n    // console.log(fetchUsers);\n\n    /*   const result = (await index.search(searchInput)).hits.map((cur) =>\n      cur.objectID !== user.uid\n        ? {\n            ...cur,\n            id: cur.photoURL\n              ? cur.objectID > user.uid\n                ? cur.objectID + user.uid\n                : user.uid + cur.objectID\n              : cur.objectID,\n            userID: cur.photoURL ? cur.objectID : null,\n          }\n        : null\n    );\n    console.log(result);\n    setSearchList(result);*/\n\n    var filtered = users.filter(function (element, index, array) {\n      return element.name.toLowerCase().indexOf(searchInput.toLowerCase()) > -1;\n    });\n    // console.log(filtered);\n\n    setSearchListy(filtered);\n\n    /*  const findMessage = function (users) { \n          return users; \n      };\n      const result = (users.filter(findMessage(searchInput)).map((user) => \n        user.photoURL,\n        user.uid\n        ))\n      setSearchList(result);*/\n\n    //const count = 65;\n  }\n\n  //  debugger;\n  const createChat = () => {\n    const roomName = prompt(\"Type the name of your room\");\n    if (roomName) {\n      db.collection(\"rooms\").add({\n        name: roomName,\n        timestamp: createTimestamp(),\n        lastMessage: \"\",\n      });\n    }\n  };\n\n  // Открытие левого бара\n  const handleDrawerLeftOpen = () => {\n    //   setMenuSidebar(null);\n    setDrawerLeft(true);\n  };\n  useEffect(() => {\n    const data = {};\n    chats.forEach((cur) => {\n      if (cur.unreadMessages || cur.unreadMessages === 0) {\n        if (\n          (cur.unreadMessages > prevUnreadMessages.current[cur.id] ||\n            (!prevUnreadMessages.current[cur.id] &&\n              prevUnreadMessages.current[cur.id] !== 0)) &&\n          pathID !== cur.id\n        ) {\n          notification.play();\n        }\n        data[cur.id] = cur.unreadMessages;\n      }\n    });\n    prevUnreadMessages.current = data;\n  }, [chats, pathID]);\n\n  useEffect(() => {\n    if (page.width <= 160 && chats && !mounted) {\n      setMounted(true);\n      setTimeout(() => {\n        document.querySelector(\".sidebar\").classList.add(\"side\");\n      }, 10);\n    }\n  }, [chats, mounted]);\n\n  async function searchDr() {\n    if (menu !== 3) {\n      setMenu(3);\n    }\n\n    var filteredRole = users.filter(function (element, index, array) {\n      return (\n        element.searchrole\n          .toLowerCase()\n         // .indexOf(localStorage.getItem(\"role\").toLowerCase()) > -1\n          .indexOf(\"Пассажир\".toLowerCase()) > -1\n      );\n    });\n\n   // console.log(filteredRole);\n\n    setSearchRole(filteredRole);\n  }\n\n  async function searchPas() {\n    if (menu !== 2) {\n      setMenu(2);\n    }\n\n    var filteredRole = users.filter(function (element, index, array) {\n      return (\n        element.searchrole\n          .toLowerCase()\n          .indexOf(\"Водитель\".toLowerCase()) > -1\n      );\n    });\n\n    //console.log(filteredRole);\n\n    setSearchRole(filteredRole);\n  }\n  async function searchHome() {\n    if (menu !== 1) {\n      setMenu(1);\n    } \n    history.push(\"/\");\n  }\n  return (\n    <div\n      className=\"sidebar\"\n      style={{\n     //   minHeight: page.width <= 760 ? page.height : \"auto\",\n      }}\n    >\n      {/*<p>Sidebar.js</p>*/}\n      <div className=\"sidebar__header\">\n        <div className=\"sidebar__header--left\">\n          <Avatar src={user?.photoURL} onClick={() => handleDrawerLeftOpen()} />\n          <h4>{user?.displayName} </h4>\n        </div>\n\n        <DrawerLeft\n          drawerLeft={drawerLeft}\n          setDrawerLeft={setDrawerLeft}\n          db={db}\n          auth={auth}\n          storage={storage1}\n        />\n        <div className=\"sidebar__header--right\">\n          <IconButton\n            onClick={() => {\n              if (pwa) {\n                console.log(\"prompting the pwa event\");\n                pwa.prompt();\n              } else {\n                console.log(\"pwa event is undefined\");\n              }\n            }}\n          >\n            <GetAppRounded />\n          </IconButton>\n          <YourRole uid={user.uid} />\n          {/* <IconButton\n            onClick={() => {\n              auth.signOut();\n              db.doc(\"/users/\" + user.uid).set(\n                { state: \"offline\" },\n                { merge: true }\n              );\n              history.replace(\"/chats\");\n              setTimeout(() => {\n                window.location.reload();\n              }, 1000);\n            }}\n          >\n            <LogOut />\n          </IconButton>*/}\n        </div>\n      </div>\n\n      <div className=\"sidebar__search\">\n        <form className=\"sidebar__search--container\">\n          <SearchOutlined />\n          <input\n            value={searchInput}\n            onChange={(e) => setSearchInput(e.target.value)}\n            placeholder=\"Поиск\"\n            type=\"text\"\n          />\n          <button\n            style={{ display: \"none\" }}\n            type=\"submit\"\n            onClick={search}\n          ></button>\n        </form>\n      </div>\n\n      <div className=\"sidebar__menu\">\n        <Nav\n          classSelected={menu === 1 ? true : false}\n          to=\"/\"\n          click={() => setMenu(1), searchHome}\n          activeClassName=\"sidebar__menu--selected\"\n        >\n          <div className=\"sidebar__menu--users\">\n            <Home />\n            <div className=\"sidebar__menu--line\"></div>\n          </div>\n        </Nav>\n        <Nav\n          classSelected={menu === 2 ? true : false}\n          to=\"/users\"\n          click={() => setMenu(2), searchPas}\n          activeClassName=\"sidebar__menu--selected\"\n        >\n          <div className=\"sidebar__menu--users\">\n            <PeopleAlt />\n            <div className=\"sidebar__menu--line\"></div>\n          </div>\n        </Nav>\n        <Nav\n          classSelected={menu === 3 ? true : false}\n          to=\"/users\"\n          click={() => setMenu(3), searchDr}\n          activeClassName=\"sidebar__menu--selected\"\n        >\n          <div className=\"sidebar__menu--users\">\n            <DriveEta />\n            <div className=\"sidebar__menu--line\"></div>\n          </div>\n        </Nav>\n      </div>\n\n      {page.width <= 160 ? (\n        <>\n          <Switch>\n            <Route path=\"/users\">\n              <SidebarChat\n                key=\"users\"\n                fetchList={fetchUsers}\n                dataList={users}\n                title=\"Users\"\n                path=\"/users\"\n              />\n            </Route>\n            <Route path=\"/rooms\">\n              <SidebarChat\n                key=\"rooms\"\n                fetchList={fetchRooms}\n                dataList={rooms}\n                title=\"Rooms\"\n                path=\"/rooms\"\n              />\n            </Route>\n            <Route path=\"/search\">\n              <SidebarChat\n                key=\"search\"\n                fetchList={fetchUsers}\n                dataList={searchListy}\n                title=\"Search Result\"\n                path=\"/search\"\n              />\n            </Route>\n            <Route path=\"/chats\">\n              <SidebarChat\n                key=\"chats\"\n                dataList={chats}\n                title=\"Chats1\"\n                path=\"/chats\"\n              />\n            </Route>\n          </Switch>\n        </>\n      ) : menu === 1 ? (\n        <SidebarChat\n        key=\"users\"\n        fetchList={fetchUsers}\n        dataList={users}\n   //   title=\"Все\"\n      />\n      ) : menu === 2 ? (\n        <SidebarChat\n          key=\"usersPas\"\n          fetchList={fetchUsers}\n          dataList={searchRole}\n          title=\"Пассажиры\"\n        />\n      ) : menu === 3 ? (\n        <SidebarChat\n          key=\"usersDr\"\n          fetchList={fetchUsers}\n          dataList={searchRole}\n          title=\"Водители\"\n        />\n      ) : menu === 4 ? (\n        <SidebarChat\n          key=\"search\"\n          fetchList={fetchUsers}\n          dataList={searchListy}\n          title=\"Поиск\"\n          //   key=\"search\"\n          // dataList={searchList}\n          // title=\"Результат поиска\"\n        />\n      ) : null}\n    </div>\n  );\n}\n\nexport default memo(Sidebar);\n","import {memo, useEffect, useState} from \"react\";\nimport CloseRoundedIcon from '@material-ui/icons/CloseRounded';\nimport \"./MediaPreview.css\";\n\nexport default memo(function MediaPreview({imageSRC, mediaPreview, close}) {\n\tconst [height, setHeight] = useState(\"\");\n\n\tuseEffect(() => {\n\t\tsetHeight(document.querySelector('.chat__body--container').offsetHeight);\n\t}, [])\n\n\treturn(\n\t\t<div \n\t\t\tref={mediaPreview} \n\t\t\tclassName=\"mediaPreview\"\n\t\t\tstyle={{\n\t\t\t\theight: height,\n\t\t\t}}\n\t\t>\n\t\t\t<CloseRoundedIcon onClick={close} />\n\t\t\t<img key={imageSRC} src={imageSRC} alt=\"\" />\n\t\t</div>\n\t)\n})","import { useEffect, memo, useState } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { useHistory } from 'react-router-dom';\nimport { useStateValue } from './StateProvider';\nimport CloseRoundedIcon from '@material-ui/icons/CloseRounded';\nimport \"./ImagePreview.css\"\n\nexport default memo(function ImagePreview({ imagePreview, animState }) {\n    const history = useHistory();\n    const [loaded, setLoaded] = useState(false);\n    const [{page}] = useStateValue();\n    \n    useEffect(() => {\n        if (loaded) {\n            const ratio = page.height / page.width;\n            const el = document.querySelector('.imagePreview-container');\n            var animW, animH, a;\n            const imageRatio = imagePreview.ratio ? imagePreview.ratio : (imagePreview.imgH / imagePreview.imgW);\n            if (ratio  < imageRatio) {\n                a = true;\n                animW = (1 / imageRatio) * page.height;\n                animH = page.height;\n            } else {\n                a = false;\n                animH = imageRatio * page.width;\n                animW = page.width;\n            }\n            if (animState === \"entering\" || animState === \"entered\") {\n                setTimeout(() => {\n                    document.querySelector(\".imagePreview\").style.backgroundColor = \"black\";\n                    el.style.borderRadius = \"0px\"\n                    el.style.transformOrigin = a ? \"0% 0%\" : \"0% 0%\";\n                    el.style.height = imagePreview.imgH + \"px\";\n                    el.style.transform = a ? `translateX(${(page.width / 2) - (animW / 2)}px) translateY(0px) scale(${page.height / imagePreview.imgH})` : \n                            `translateX(0px) translateY(${(page.height / 2) - (animH / 2)}px) scale(${page.width / imagePreview.width})`\n                    setTimeout(() => {\n                        document.querySelector('.imagePreview .MuiSvgIcon-root').classList.add(\"close-animate\")\n                    }, 300)\n                }, 10)\n            } else if (animState === \"exiting\") {\n                setTimeout(() => {\n                    document.querySelector('.imagePreview .MuiSvgIcon-root').classList.remove(\"close-animate\")\n                    setTimeout(() => {\n                        document.querySelector(\".imagePreview\").style.backgroundColor = \"transparent\"\n                    }, 200)\n                    el.style.borderRadius = \"10px\"\n                    el.style.height = imagePreview.height + \"px\";\n                    el.style.transform = `translateX(${imagePreview.left}px) translateY(${imagePreview.top}px) scale(1)`;\n                }, 10)\n            }\n        }\n    }, [animState, loaded]);\n\n    const style = {\n        transform:`translateX(${imagePreview.left}px) translateY(${imagePreview.top}px) scale(1)`,\n        width: imagePreview.width,\n        height: imagePreview.height,\n    }\n\n    const imgStyle = {}\n\n    if (page.height / page.width > imagePreview.ratio || page.height / page.width === imagePreview.ratio) {\n        imgStyle.minWidth = \"100%\";\n    } else {\n        imgStyle.minHeight = \"100%\";\n        if (imagePreview.imgW < imagePreview.width) {\n            imgStyle.minWidth = \"100%\";\n        }\n    }\n       \n    return createPortal(\n        <div className=\"imagePreview\" onClick={() => document.querySelector('.imagePreview .MuiSvgIcon-root').classList.toggle(\"close-animate\")}>\n            <CloseRoundedIcon onClick={() => history.goBack()} />\n            <div\n                className=\"imagePreview-container\"\n                style={style}\n            >\n                <img style={imgStyle} onLoad={() => setLoaded(true)} src={imagePreview.src} alt=\"\" />\n            </div>\n        </div>\n    , document.querySelector(\".app\"))\n})","import { v4 as uuidv4 } from 'uuid';\n\nexport default function record (){\n  return new Promise(resolve => {\n    navigator.mediaDevices.getUserMedia({ audio: true })\n      .then(stream => {\n        const mediaRecorder = new MediaRecorder(stream);\n        const audioChunks = [];\n\n        mediaRecorder.addEventListener(\"dataavailable\", event => {\n          audioChunks.push(event.data);\n        });\n\n        const start = () => {\n          mediaRecorder.start();\n        };\n\n        const stop = () => {\n          return new Promise(resolve => {\n            mediaRecorder.addEventListener(\"stop\", () => {\n              const audioName = uuidv4();\n              const audioFile = new File(audioChunks, audioName, {type: \"audio/mpeg\"});\n              const audioUrl = URL.createObjectURL(audioFile);\n              const audio = new Audio(audioUrl);\n              const play = () => {\n                audio.play();\n              };\n\n              resolve({ audioFile, audioUrl, play, audioName });\n            });\n\n            mediaRecorder.stop();\n          });\n        };\n\n        resolve({ start, stop });\n      });\n  });\n};","import { memo, useState, useEffect, useRef } from 'react';\nimport { Send, MicRounded, CancelRounded, CheckCircleRounded } from '@material-ui/icons';\nimport db, { createTimestamp, fieldIncrement, audioStorage } from \"./firebase\";\nimport { useStateValue } from './StateProvider';\nimport { CSSTransition } from \"react-transition-group\";\nimport recorder from \"./recorder.js\";\nimport { v4 as uuidv4 } from 'uuid';\nimport \"./ChatFooter.css\";\nconst wait = time => new Promise(resolve => setTimeout(resolve, time));\n\nexport default memo(function ChatFooter({input, handleFocus, change, sendMessage, setFocus, image, focus, state, token, roomID, setAudioID}) {\n\tconst [recording, setRecording] = useState(false);\n\tconst [recordingTimer, setRecordingTimer] = useState(\"00:00\");\n\tconst [{ user }] = useStateValue();\n\tconst recordingEl = useRef();\n\tconst inputRef = useRef();\n\tconst timerInterval = useRef();\n\tconst record = useRef();\n\n\tfunction handleBlur(event) {\n\t    if (!event.currentTarget.contains(event.relatedTarget) && !recording) {\n\t    \tsetFocus(false)\n\t    }\n\t}\n\n\tasync function sendAudio(audioFile, timer, audioName) {\n\t\tdb.collection(\"rooms\").doc(roomID).set({\n            [user.uid]: false,\n        }, { merge: true });\n\t\tdb.collection(\"rooms\").doc(roomID).set({\n\t\t\tlastMessage:{\n\t\t\t\taudio: true,\n\t\t\t\ttime: timer,\n\t\t\t},\n\t\t\tseen: false\n\t\t}, { merge: true });\n        if (state.userID) {\n        \tdb.collection(\"users\").doc(state.userID).collection(\"chats\").doc(roomID).set({\n                timestamp: createTimestamp(),\n                photoURL: user.photoURL ? user.photoURL : null,\n                name: user.displayName,\n                userID: user.uid,\n                unreadMessages: fieldIncrement(1),\n            }, { merge: true });\n            db.collection(\"users\").doc(user.uid).collection(\"chats\").doc(roomID).set({\n                timestamp: createTimestamp(),\n                photoURL: state.photoURL ? state.photoURL : null,\n                name: state.name,\n                userID: state.userID\n            }, { merge: true });\n        } else {\n        \tdb.collection(\"users\").doc(user.uid).collection(\"chats\").doc(roomID).set({\n                timestamp: createTimestamp(),\n                photoURL: state.photoURL ? state.photoURL : null,\n                name: state.name,\n            });\n        };\n        const doc = await db.collection(\"rooms\").doc(roomID).collection(\"messages\").add({\n        \tname: user.displayName,\n            uid: user.uid,\n            timestamp: createTimestamp(),\n            time: new Date().toUTCString(),\n            audioUrl: \"uploading\",\n            audioName,\n            audioPlayed: false\n        });\n        await audioStorage.child(audioName).put(audioFile);\n        const url = await audioStorage.child(audioName).getDownloadURL();\n        db.collection(\"rooms\").doc(roomID).collection(\"messages\").doc(doc.id).update({\n            audioUrl: url\n        });\n        if (state.userID && token !== \"\") {\n        \tdb.collection(\"notifications\").add({\n\t            userID: user.uid,\n\t            title: user.displayName,\n\t            body: \"🎙️ \" + timer,\n\t            photoURL: user.photoURL,\n\t            token: token\n\t        });\n        };\n\t};\n\n\tasync function startRecording(e) {\n\t\te.preventDefault();\n\t\tif (window.navigator.onLine) {\n\t\t\tif (focus) {\n\t\t\t\tinputRef.current.focus();\n\t\t\t}\n\t\t\tawait wait(150);\n\t\t\trecord.current = await recorder(roomID);\n\t\t\tsetAudioID(null);\n\t\t\tinputRef.current.style.width = \"calc(100% - 56px)\"\n\t\t\tawait wait(305);\n\t\t\tsetRecording(true);\n\t\t} else {\n\t\t\talert(\"No access to internet !!!\");\n\t\t}\n\t}\n\n\tasync function stopRecording() {\n\t\tif (focus) {\n\t\t\tinputRef.current.focus();\n\t\t}\n\t\tdb.collection(\"rooms\").doc(roomID).set({\n            [user.uid]: false,\n        }, { merge: true });\n\t\tclearInterval(timerInterval.current);\n\t\tconst stopped = record.current.stop();\n\t\trecordingEl.current.style.opacity = \"0\";\n\t\tawait wait(300);\n\t\tsetRecording(false);\n\t\tinputRef.current.style.width = \"calc(100% - 112px)\";\n\t\tconst time = recordingTimer;\n\t\tsetRecordingTimer(\"00:00\");\n\t\treturn [stopped, time];\n\t}\n\n\tasync function finishRecording() {\n\t\tvar [audio, time] = await stopRecording();\n\t\taudio = await audio;\n\t\tsendAudio(audio.audioFile, time, audio.audioName);\n\t}\n\n\tfunction pad(val) {\n        var valString = val + \"\";\n        if(valString.length < 2) {\n            return \"0\" + valString;\n        } else {\n            return valString;\n        }\n    }\n\n\tfunction timer() {\n        const start = Date.now();\n        timerInterval.current = setInterval(setTime, 100);\n\n        function setTime() {\n            const delta = Date.now() - start; // milliseconds elapsed since start\n            const totalSeconds = Math.floor(delta / 1000);\n            setRecordingTimer(pad(parseInt(totalSeconds/60)) + \":\" + pad(totalSeconds%60))\n        }\n\t}\n\n\tfunction audioInputChange(e) {\n\t\tif (window.navigator.onLine) {\n\t\t\tconst file = e.target.files[0];\n\t\t\tif (file) {\n\t\t\t\tsetAudioID(null);\n\t\t\t\tconst audioFile = new Audio(URL.createObjectURL(file));\n\t\t\t\taudioFile.addEventListener(\"loadedmetadata\", () => {\n\t\t\t\t\tconst totalSeconds = Math.floor(audioFile.duration);\n\t\t\t\t\tconst time = pad(parseInt(totalSeconds/60)) + \":\" + pad(totalSeconds%60);\n\t\t\t\t\tsendAudio(file,time, uuidv4());\n\t\t\t\t});\n\t\t\t};\n\t\t} else {\n\t\t\talert(\"Нет подключения к интернету!\");\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tconst a = async () => {\n\t\t\tawait wait(10);\n\t\t\trecordingEl.current.style.opacity = \"1\";\n\t\t\tawait wait(100);\n\t\t\ttimer();\n\t\t\tdb.collection(\"rooms\").doc(roomID).set({\n                [user.uid]: \"recording\",\n            }, { merge: true })\n\t\t\trecord.current.start();\n\t\t}\n\t\tif (recording) {\n\t\t\ta();\n\t\t}\n\t}, [recording]);\n\n\tconst btnIcons = <>\n\t\t<CSSTransition\n        \tin={input !== \"\" || (input === \"\" && image)}\n        \ttimeout={{\n        \t\tenter: 400,\n        \t\texit: 200,\n        \t}}\n        \tclassNames=\"send__animate2\"\n        >\n        \t<Send \n            \tstyle={{\n                    width: 20,\n                    height: 20,\n                    color: \"white\"\n                }}\n            />\n        </CSSTransition>\n        <CSSTransition\n        \tin={!(input !== \"\" || (input === \"\" && image))}\n        \ttimeout={{\n        \t\tenter: 400,\n        \t\texit: 200,\n        \t}}\n        \tclassNames=\"send__animate\"\n        >\n        \t<MicRounded \n            \tstyle={{\n            \t\twidth: 24,\n                    height: 24,\n                    color: \"white\"\n            \t}}\n            />\n    \t</CSSTransition>\n\t</>;\n\n\treturn (\n\t\t<div className=\"chat__footer\" onBlur={handleBlur} > \n\t\t\t   {/* <p>ChatFooter.js</p>*/}\n\t        <form>\n\t            <input\n\t            \tref={inputRef}\n\t                value={input}\n\t                onClick={handleFocus}\n\t                onChange={!recording ? change : null}\n\t                onKeyPress={recording ? () => false : null}\n\t                onFocus={() => setFocus(true)}\n\t                placeholder=\"Пишите\"\n\t            />\n\t            {navigator.mediaDevices.getUserMedia && window.MediaRecorder ?\n\t            \t<button \n\t\t            \ttype=\"submit\" \n\t\t            \tclassName=\"send__btn\" \n\t\t            \tonClick={input !== \"\" || (input === \"\" && image) ? sendMessage : startRecording}\n\t\t            >\n\t\t                {btnIcons}\n\t\t            </button>\t\n\t\t        :\n\t\t        \t<>\n\t\t        \t\t<label\n\t\t\t        \t\tfor=\"capture\"  \n\t\t\t            \tclassName=\"send__btn\" \n\t\t\t            >\n\t\t\t                {btnIcons}\n\t\t\t            </label> \n\t\t\t        \t<input\n\t\t\t        \t\tstyle={{display: \"none\"}} \n\t\t\t\t        \ttype=\"file\" \n\t\t\t\t            id=\"capture\" \n\t\t\t\t            accept=\"audio/*\" \n\t\t\t\t            capture\n\t\t\t\t            onChange={audioInputChange}  \n\t\t\t            />\n\t\t        \t</>\n\t\t        }\n\t            \n\t        </form>\n\t        {recording ?\n\t\t        <div ref={recordingEl} className=\"record\">\n\t\t        \t<CancelRounded\n\t\t        \t\tstyle={{\n\t                \t\twidth: 30,\n\t\t                    height: 30,\n\t\t                    color: \"#F20519\"\n\t                \t}}\n\t                \tonClick={stopRecording}\n\t\t        \t/>\n\t\t        \t<div>\n\t\t        \t\t<div className=\"record__redcircle\"></div>\n\t\t        \t\t<div className=\"record__duration\">{recordingTimer}</div>\n\t\t        \t</div>\n\t\t        \t<CheckCircleRounded\n\t\t        \t\tstyle={{\n\t                \t\twidth: 30,\n\t\t                    height: 30,\n\t\t                    color: \"#41BF49\"\n\t                \t}}\n\t                \tonClick={finishRecording} \n\t\t        \t/>\n\t\t        </div> : null\n\t\t    }\n\t    </div>\n\t)\n})","import { useState, useEffect, memo, useRef } from 'react';\nimport PlayArrowRoundedIcon from '@material-ui/icons/PlayArrowRounded';\nimport PauseRoundedIcon from '@material-ui/icons/PauseRounded';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport PlayForWorkRoundedIcon from '@material-ui/icons/PlayForWorkRounded';\nimport db from \"./firebase\";\nimport \"./AudioPlayer.css\"\n\nexport default memo(function AudioPlayer({sender, roomID, audioUrl, id, setAudioID, audioID, animState, audioPlayed}) {\n\tconst [isPlaying, setIsPlaying] = useState(false);\n\tconst [mediaLoaded, setMediaLoaded] = useState(false);\n\tconst [loaded, setLoaded] = useState(false);\n\tconst [metadataLoaded, setMetadataLoaded] = useState(false);\n\tconst [error, setError] = useState(false);\n\tconst [sliderValue, setSliderValue] = useState(0);\n\tconst [sliderPlayedWidth, setSliderPlayedWidth] = useState(\"0%\");\n\tconst [duration, setDuration] = useState(\"\");\n\tconst totalDuration = useRef(\"\");\n\tconst audio = useRef(new Audio(audioUrl));\n\tconst interval = useRef();\n\tconst uploading = useRef(audioUrl === \"uploading\");\n\n\tfunction play () {\n\t\taudio.current.play();\n\t\tif (!audioPlayed && !sender) {\n\t\t\tdb.collection(\"rooms\").doc(roomID).collection(\"messages\").doc(id).set({\n\t\t\t\taudioPlayed: true\n\t\t\t}, {merge: true});\n\t\t}\n\t\tif (audioID !== id) {\n\t\t\tsetAudioID(id);\n\t\t}\n\t\tinterval.current = setInterval(seekUpdate, 50);\n\t\tsetIsPlaying(true);\n\t}\n\n\tfunction pause() {\n\t\taudio.current.pause();\n\t\tclearInterval(interval.current);\n\t\tsetIsPlaying(false);\n\t\tsetDuration(totalDuration.current);\n\t}\n\n\tfunction inputChange(e) {\n\t\tconst value = e.target.value;\n\t\tif (mediaLoaded) {\n\t\t\tconst seekto = audio.current.duration * (value / 100);\n\t\t\taudio.current.currentTime = seekto;\n\t\t\tsetSliderValue(value);\n\t\t\tsetSliderPlayedWidth(`${value - 5.7 * (value / 100)}%`);\n\t\t}\n\t}\n\n\tfunction getCurrentTime() {\n\t\t// Calculate the time left and the total duration \n\t\tlet currentMinutes = Math.floor(audio.current.currentTime / 60); \n\t\tlet currentSeconds = Math.floor(audio.current.currentTime - currentMinutes * 60); \n\n\t\t// Add a zero to the single digit time values \n\t\tif (currentSeconds < 10) { currentSeconds = \"0\" + currentSeconds; } \n\t\tif (currentMinutes < 10) { currentMinutes = \"0\" + currentMinutes; } \n\n\t\t// Display the updated duration \n\t\treturn  currentMinutes + \":\" + currentSeconds; \n\t}\n\n\tfunction seekUpdate() { \n\t\tlet seekPosition = 0; \n\t\t// Check if the current track duration is a legible number \n\t\tif (!isNaN(audio.current.duration)) { \n\t\t\tseekPosition = audio.current.currentTime * (100 / audio.current.duration); \n\t\t\tsetSliderValue(seekPosition);\n\t\t\tsetSliderPlayedWidth(seekPosition + \"%\"); \n\t\t\tsetDuration(getCurrentTime());\n\t\t} \n\t}\n\n\tfunction loadAudioAgain() {\n\t\taudio.current.load();\n\t\tsetError(false);\n\t}\n\n\tfunction calculateMediaDuration(media){\n\t  return new Promise( (resolve,reject)=>{\n\t    media.onloadedmetadata = function(){\n\t      // set the mediaElement.currentTime  to a high value beyond its real duration\n\t      media.currentTime = Number.MAX_SAFE_INTEGER;\n\t      // listen to time position change\n\t      media.ontimeupdate = function(){\n\t        media.ontimeupdate = function(){};\n\t        // setting player currentTime back to 0 can be buggy too, set it first to .1 sec\n\t        media.currentTime = 0.1;\n\t        media.currentTime = 0;\n\t        // media.duration should now have its correct value, return it...\n\t        resolve(media.duration);\n\t      }\n\t    }\n\t  });\n\t};\n\t\n\tuseEffect(() => {\n\t\tif (uploading.current === true && audioUrl !== \"uploading\") {\n\t\t\taudio.current = new Audio(audioUrl);\n\t\t\taudio.current.load();\n\t\t\tsetLoaded(true);\n\t\t} else if (uploading.current === false) {\n\t\t\tsetLoaded(true);\n\t\t}\n\t}, [audioUrl]);\n\n\tuseEffect(() => {\n\t\tif (loaded) {\n\t\t\taudio.current.addEventListener(\"error\", () => {\n\t\t\t\tsetError(true);\n\t\t\t});\n\t\t\tcalculateMediaDuration(audio.current).then(() => {\n\t\t\t\tsetMetadataLoaded(true);\n\t\t\t})\n\t\t}\n\t}, [loaded]); \n\n\tuseEffect(() => {\n\t\tif (metadataLoaded) {\n\t\t\taudio.current.addEventListener(\"canplaythrough\", async () => {\n\t\t\t\tif (totalDuration.current === \"\") {\n\t\t\t\t\tsetMediaLoaded(true);\n\t\t\t\t\tlet durationMinutes = Math.floor(audio.current.duration / 60); \n\t\t\t\t\tlet durationSeconds = Math.floor(audio.current.duration - durationMinutes * 60); \n\t\t\t\t\t// Add a zero to the single digit time values \n\t\t\t\t\tif (durationSeconds < 10) { durationSeconds = \"0\" + durationSeconds; } \n\t\t\t\t\tif (durationMinutes < 10) { durationMinutes = \"0\" + durationMinutes; } \n\t\t\t\t\t// Display the updated duration \n\t\t\t\t\ttotalDuration.current = durationMinutes + \":\" + durationSeconds;\n\t\t\t\t\tsetDuration(totalDuration.current);\n\t\t\t\t}\n\t\t\t});\n\t\t\taudio.current.addEventListener(\"ended\", () => {\n\t\t\t\tclearInterval(interval.current);\n\t\t\t\tsetDuration(totalDuration.current);\n\t\t\t\tsetSliderValue(0);\n\t\t\t\tsetSliderPlayedWidth(\"0%\");\n\t\t\t\tsetIsPlaying(false);\n\t\t\t});\n\t\t}\n\t}, [metadataLoaded]);\n\n\tuseEffect(() => {\n\t\tif (animState === \"exiting\") {\n\t\t\taudio.current.pause();\n\t\t}\n\t}, [animState]);\n\n\tuseEffect(() => {\n\t\tif (audioID !== id) {\n\t\t\taudio.current.pause();\n\t\t\tsetIsPlaying(false);\n\t\t}\n\t}, [audioID])\n\n\treturn (\n\t\t<>\n\t\t\t<div className={`${sender ? \"audioplayer\" : \"audioplayer audioplayer2\"} ${audioPlayed ? \"audioplayer__played\" : \"\"}`}>\n\t\t\t\t{!mediaLoaded && !error ?\n\t\t\t\t\t<CircularProgress />\n\t\t\t\t: isPlaying && !error? \n\t\t\t\t\t<PauseRoundedIcon className=\"pause\" onClick={pause} /> \n\t\t\t\t: !isPlaying && !error ?\n\t\t\t\t\t<PlayArrowRoundedIcon onClick={play} />\n\t\t\t\t: \n\t\t\t\t\t<PlayForWorkRoundedIcon onClick={loadAudioAgain} />\n\t\t\t\t}\n\t\t\t\t<div>\n\t\t\t\t\t<span \n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\twidth: sliderPlayedWidth,\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclassName=\"audioplayer__slider--played\" \n\t\t\t\t\t></span>\n\t\t\t\t\t<input\t\n\t\t\t\t\t\ttype=\"range\" min=\"1\" max=\"100\" value={sliderValue}\n\t\t\t\t\t\tonChange={inputChange} className=\"audioplayer__slider\"\n\t\t\t\t\t></input>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<span className=\"chat__timestamp audioplayer__time\">{duration}</span>\n\t\t</>\n\t)\n})","export default __webpack_public_path__ + \"static/media/message_sent.3957aabd.mp3\";","export default __webpack_public_path__ + \"static/media/message_received.7170470c.mp3\";","import { useState, useEffect, useLayoutEffect, useRef, memo } from \"react\";\nimport { Avatar, IconButton } from \"@material-ui/core\";\nimport {\n  TransitionGroup,\n  Transition,\n  CSSTransition,\n} from \"react-transition-group\";\nimport {\n  AddPhotoAlternate,\n  MoreVert,\n  DoneAllRounded,\n  ArrowDownward,\n  ArrowBack,\n} from \"@material-ui/icons\";\nimport {\n  useParams,\n  useRouteMatch,\n  useLocation,\n  Link,\n  Route,\n  useHistory,\n} from \"react-router-dom\";\nimport db, {\n  auth,\n  createTimestamp,\n  fieldIncrement,\n  storage,\n  audioStorage,\n} from \"./firebase\";\nimport { useStateValue } from \"./StateProvider\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport MediaPreview from \"./MediaPreview\";\nimport ImagePreview from \"./ImagePreview\";\nimport ChatFooter from \"./ChatFooter\";\nimport Compressor from \"compressorjs\";\nimport anime from \"animejs/lib/anime.es.js\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport AudioPlayer from \"./AudioPlayer.js\";\nimport \"./Chat.css\";\nimport audio2 from \"./message_sent.mp3\";\nimport audio1 from \"./message_received.mp3\";\n\nimport {\n  Message,\n  PeopleAlt,\n  Home,\n  ExitToApp as LogOut,\n  SearchOutlined,\n  GetAppRounded,\n  Delete, \n  VisibilityOff\n} from \"@material-ui/icons\";\n//import PublicOffIcon from '@mui/icons-material/PublicOff';\n\nfunction Chat({ animState, unreadMessages, b }) {\n  const [input, setInput] = useState(\"\");\n  const { roomID } = useParams();\n  const location = useLocation();\n  const match = useRouteMatch();\n  const [{ dispatchMessages, user, roomsData, page }, dispatch, actionTypes] =\n    useStateValue();\n  const [imagePreview, setImagePreview] = useState({});\n  const [messages, setMessages] = useState([]);\n  const [openMenu, setOpenMenu] = useState(null);\n  const [deleting, setDeleting] = useState(false);\n  const [focus, setFocus] = useState(false);\n  const [token, setToken] = useState(\"\");\n  const [state, setState] = useState(location.state ? location.state : {});\n  const [seen, setSeen] = useState(false);\n  const [typing, setTyping] = useState(false);\n  const [src, setSRC] = useState(\"\");\n  const [image, setImage] = useState(null);\n  const [writeState, setWriteState] = useState(0);\n  const [ratio, setRatio] = useState(false);\n  const [scrollArrow, setScrollArrow] = useState(false);\n  const [clientWidth, setClientWidth] = useState(null);\n  const [firstRender, setFirstRender] = useState(false);\n  const [sendAnim, setSendAnim] = useState(false);\n  const [limitReached, setLimitReached] = useState(\n    Boolean(dispatchMessages[roomID]?.limitReached)\n  );\n  const history = useHistory();\n  const chatBodyRef = useRef();\n  const lastMessageRef = useRef();\n  const chatBodyContainer = useRef();\n  const chatAnim = useRef();\n  const mediaPreview = useRef();\n  const prevMessages = useRef([]);\n  const limit = useRef(30);\n  const prevScrollHeight = useRef(null);\n  const [audioID, setAudioID] = useState(null);\n  const paginating = useRef(null);\n  const paginating2 = useRef(null);\n  const [paginateLoader, setPaginateLoader] = useState(false);\n  const messageSentAudio = new Audio(audio2);\n  const messageReceivedAudio = new Audio(audio1);\n  const mediaSnap = useRef([]);\n  const mediaChecked = useRef(false);\n\n  //console.log(match)\n  const change = (e) => {\n    clearTimeout(writeState);\n    setInput(e.target.value);\n    if (state?.userID) {\n      db.collection(\"rooms\")\n        .doc(roomID)\n        .set(\n          {\n            [user.uid]: true,\n          },\n          { merge: true }\n        )\n        .then(() => {\n          setWriteState(\n            setTimeout(() => {\n              db.collection(\"rooms\")\n                .doc(roomID)\n                .set(\n                  {\n                    [user.uid]: false,\n                  },\n                  { merge: true }\n                );\n            }, 1000)\n          );\n        });\n    }\n  };\n\n  const clickImagePreview = (event, src, ratio) => {\n    const target = event.target;\n    const node = target.parentNode.parentNode;\n    const obj = node.getBoundingClientRect();\n    setImagePreview({\n      ratio: ratio,\n      top:\n        page.transform === \"scale(1)\"\n          ? obj.top\n          : obj.top / (window.innerHeight / page.height),\n      left:\n        page.transform === \"scale(1)\"\n          ? obj.left\n          : obj.left / (window.innerWidth / page.width),\n      width: node.offsetWidth,\n      height: node.offsetHeight,\n      imgW: target.offsetWidth,\n      imgH: target.offsetHeight,\n      src,\n    });\n  };\n\n  const close = () => {\n    mediaPreview.current.style.animation = \"opacity-out 300ms ease forwards\";\n    setTimeout(() => {\n      setImage(null);\n      setSRC(\"\");\n    }, 310);\n  };\n\n  const handleFile = (event) => {\n    if (window.navigator.onLine) {\n      if (event.target.files[0]) {\n        var reader = new FileReader();\n        reader.onload = function () {\n          setSRC(reader.result);\n        };\n        reader.readAsDataURL(event.target.files[0]);\n        setImage(event.target.files[0]);\n      }\n    } else {\n      alert(\"Нет подключения к интернету!\");\n    }\n  };\n  //window\n  const scrollChatBody = () => {\n    const nodeArr = Array.from(document.querySelectorAll(\".chat__message\"));\n    const height =\n      outerHeight(nodeArr[nodeArr.length - 2]) +\n      outerHeight(nodeArr[nodeArr.length - 3]) +\n      outerHeight(nodeArr[nodeArr.length - 4]);\n    const lastMHeight = height < page.height / 2 ? height : page.height / 2;\n    if (\n      chatBodyContainer.current.scrollHeight -\n        chatBodyContainer.current.offsetHeight ===\n      0\n    ) {\n      setTimeout(\n        () => {\n          if (chatBodyRef.current) {\n            chatBodyRef.current.style.opacity = \"1\";\n          }\n          setFirstRender(true);\n        },\n        animState === \"entering\" ? 350 : 50\n      );\n      setTimeout(() => {\n        const node = document.querySelector(\".chat .chat__lastMessage\");\n        if (node) {\n          node.style.animation = \"none\";\n          node.style.opacity = \"1\";\n        }\n      }, 50);\n    } else if (\n      chatBodyContainer.current.scrollTop +\n        outerHeight(nodeArr[nodeArr.length - 1]) >=\n        chatBodyContainer.current.scrollHeight -\n          chatBodyContainer.current.offsetHeight -\n          lastMHeight &&\n      messages[messages.length - 1].uid !== user.uid\n    ) {\n      if (\n        chatBodyContainer.current.scrollTop !==\n        chatBodyContainer.current.scrollHeight\n      ) {\n        //console.log(\"scrolling down 1\");\n        setSendAnim(true);\n        anime({\n          targets: chatBodyContainer.current,\n          scrollTop: chatBodyContainer.current.scrollHeight,\n          duration: 800,\n          easing: \"linear\",\n          complete: function () {\n            setSendAnim(false);\n          },\n        });\n      }\n    } else if (messages[messages.length - 1].uid === user.uid) {\n      if (\n        chatBodyContainer.current.scrollTop !==\n        chatBodyContainer.current.scrollHeight\n      ) {\n        //console.log(\"scrolling down 2\");\n        setSendAnim(true);\n        anime({\n          targets: chatBodyContainer.current,\n          scrollTop: chatBodyContainer.current.scrollHeight,\n          duration: 800,\n          easing: \"linear\",\n          complete: function () {\n            setSendAnim(false);\n          },\n        });\n      }\n    } else {\n      setScrollArrow(true);\n    }\n  };\n\n  function outerHeight(el) {\n    if (el) {\n      var height = el.offsetHeight;\n      var style = getComputedStyle(el);\n\n      height += parseInt(style.marginTop) + parseInt(style.marginBottom);\n      return height;\n    }\n    return null;\n  }\n\n  const sendMessage = async (event) => {\n    event.preventDefault();\n    if (focus) {\n      document.querySelector(\".chat__footer > form > input\").focus();\n    }\n    if (input !== \"\" || (input === \"\" && image)) {\n      const inputText = input;\n      const imageToUpload = image;\n      if (imageToUpload) {\n        close();\n      }\n      setInput(\"\");\n      const roomInfo = {\n        lastMessage: imageToUpload\n          ? {\n              message: inputText,\n              audio: false,\n            }\n          : inputText,\n        seen: false,\n      };\n      db.collection(\"rooms\").doc(roomID).set(roomInfo, { merge: true });\n      var split, imageName;\n      if (imageToUpload) {\n        split = imageToUpload.name.split(\".\");\n        imageName = split[0] + uuidv4() + \".\" + split[1];\n      }\n      const messageToSend = imageToUpload\n        ? {\n            name: user.displayName,\n            message: input,\n            uid: user.uid,\n            timestamp: createTimestamp(),\n            time: new Date().toLocaleString(\"ru\", {\n              year: \"numeric\",\n              month: \"long\",\n              day: \"numeric\",\n              weekday: \"long\",\n              timezone: \"UTC\",\n              hour: \"numeric\",\n              minute: \"numeric\",\n              //  second: 'numeric'\n            }),\n            imageUrl: \"uploading\",\n            imageName: imageName,\n            ratio: ratio,\n          }\n        : {\n            name: user.displayName,\n            message: input,\n            uid: user.uid,\n            timestamp: createTimestamp(),\n            time: new Date().toLocaleString(\"ru\", {\n              year: \"numeric\",\n              month: \"long\",\n              day: \"numeric\",\n              weekday: \"long\",\n              timezone: \"UTC\",\n              hour: \"numeric\",\n              minute: \"numeric\",\n              // second: 'numeric'\n            }),\n          };\n      if (state.userID) {\n        db.collection(\"users\")\n          .doc(state.userID)\n          .collection(\"chats\")\n          .doc(roomID)\n          .set(\n            {\n              timestamp: createTimestamp(),\n              photoURL: user.photoURL ? user.photoURL : null,\n              name: user.displayName,\n              userID: user.uid,\n              unreadMessages: fieldIncrement(1),\n            },\n            { merge: true }\n          );\n        db.collection(\"users\")\n          .doc(user.uid)\n          .collection(\"chats\")\n          .doc(roomID)\n          .set(\n            {\n              timestamp: createTimestamp(),\n              photoURL: state.photoURL ? state.photoURL : null,\n              name: state.name,\n              userID: state.userID,\n            },\n            { merge: true }\n          );\n        if (token !== \"\" && !imageToUpload) {\n          db.collection(\"notifications\").add({\n            userID: user.uid,\n            title: user.displayName,\n            body: inputText,\n            photoURL: user.photoURL,\n            token: token,\n          });\n        }\n      } else {\n        db.collection(\"users\")\n          .doc(user.uid)\n          .collection(\"chats\")\n          .doc(roomID)\n          .set({\n            timestamp: createTimestamp(),\n            photoURL: state.photoURL ? state.photoURL : null,\n            name: state.name,\n          });\n      }\n      const doc = await db\n        .collection(\"rooms\")\n        .doc(roomID)\n        .collection(\"messages\")\n        .add(messageToSend);\n      if (imageToUpload) {\n        new Compressor(imageToUpload, {\n          quality: 0.8,\n          maxWidth: 1920,\n          async success(result) {\n            setSRC(\"\");\n            setImage(null);\n            await storage.child(imageName).put(result);\n            const url = await storage.child(imageName).getDownloadURL();\n            db.collection(\"rooms\")\n              .doc(roomID)\n              .collection(\"messages\")\n              .doc(doc.id)\n              .update({\n                imageUrl: url,\n              });\n            if (state.userID && token !== \"\")\n              db.collection(\"notifications\").add({\n                userID: user.uid,\n                title: user.displayName,\n                body: inputText,\n                photoURL: user.photoURL,\n                token: token,\n                image: url,\n              });\n          },\n        });\n      }\n    }\n  };\n\n  const deleteRoom = async () => {\n    if (window.navigator.onLine) {\n      setOpenMenu(false);\n      setDeleting(true);\n      try {\n        const room = db.collection(\"rooms\").doc(roomID);\n        const fetchedMessages = await room.collection(\"messages\").get();\n        const fetchedAudios = [];\n        const fecthedImages = [];\n        fetchedMessages.docs.forEach((doc) => {\n          if (doc.data().audioName) {\n            fetchedAudios.push(doc.data().audioName);\n          } else if (doc.data().imageName) {\n            fecthedImages.push(doc.data().imageName);\n          }\n        });\n        var usersChats = [];\n        if (state.userID) {\n          usersChats = [state.userID, user.uid];\n        } else {\n          usersChats = [\n            ...new Set(fetchedMessages.docs.map((cur) => cur.data().uid)),\n          ];\n        }\n        await Promise.all([\n          ...fetchedMessages.docs.map((doc) => doc.ref.delete()),\n          ...fecthedImages.map((img) => storage.child(img).delete()),\n          ...fetchedAudios.map((aud) => audioStorage.child(aud).delete()),\n          ...usersChats.map((userChat) =>\n            db\n              .collection(\"users\")\n              .doc(userChat)\n              .collection(\"chats\")\n              .doc(roomID)\n              .delete()\n          ),\n          room.delete(),\n        ]);\n        page.width <= 160 ? history.goBack() : history.replace(\"/chats\");\n      } catch (e) {\n        console.log(e.message);\n        page.width <= 160 ? history.goBack() : history.replace(\"/chats\");\n      }\n    } else {\n      alert(\"Проверьте соединение с интернетом!!!\");\n    }\n  };\n\n  const handleFocus = () => {\n    if (\n      chatBodyContainer.current.scrollTop >\n      chatBodyContainer.current.scrollHeight -\n        chatBodyContainer.current.offsetHeight -\n        120\n    ) {\n      chatBodyContainer.current.scrollTop =\n        chatBodyContainer.current.scrollHeight;\n    }\n  };\n\n  function fetchMessages(update) {\n    const ref = db\n      .collection(\"rooms\")\n      .doc(roomID)\n      .collection(\"messages\")\n      .orderBy(\"timestamp\", \"desc\");\n    if (update) {\n      b.current[roomID] = ref.limit(5).onSnapshot((snapshot) => {\n        const newMessages = snapshot.docs.map((doc) => {\n          const data = doc.data();\n          const time = data.time\n            ? data.time\n            : new Date(data.timestamp?.toDate()).toUTCString();\n          return {\n            ...data,\n            timestamp: time,\n            id: doc.id,\n          };\n        });\n        newMessages.reverse();\n        dispatch({\n          type: actionTypes.SET_MESSAGES,\n          id: roomID,\n          messages: newMessages,\n          update,\n        });\n      });\n    } else {\n      ref\n        .limit(limit.current)\n        .get()\n        .then((docs) => {\n          const newMessages = [];\n          docs.forEach((doc) => {\n            const data = doc.data();\n            const time = data.time\n              ? data.time\n              : new Date(data.timestamp?.toDate()).toUTCString();\n            newMessages.push({\n              ...data,\n              timestamp: time,\n              id: doc.id,\n            });\n          });\n          newMessages.reverse();\n          dispatch({\n            type: actionTypes.SET_MESSAGES,\n            id: roomID,\n            messages: newMessages,\n            update,\n          });\n        });\n    }\n  }\n\n  function paginate() {\n    if (\n      chatBodyContainer.current?.scrollTop === 0 &&\n      !limitReached &&\n      !paginating.current\n    ) {\n      setPaginateLoader(true);\n      prevScrollHeight.current = chatBodyContainer.current.scrollHeight;\n      paginating.current = true;\n      paginating2.current = true;\n      limit.current = messages.length + limit.current;\n      fetchMessages(false);\n    } else if (paginating2.current) {\n      prevScrollHeight.current =\n        chatBodyContainer.current.scrollHeight -\n        chatBodyContainer.current.scrollTop;\n    }\n  }\n\n  useEffect(() => {\n    if (messages.length > 0 && !deleting) {\n      if (\n        messages[messages.length - 1].id !==\n          prevMessages.current[prevMessages.current?.length - 1]?.id &&\n        dispatchMessages[roomID]?.audio\n      ) {\n        if (\n          messages[messages.length - 1].uid !== user.uid &&\n          !paginating2.current &&\n          (messages[messages.length - 1].imageUrl === \"uploading\" ||\n            !messages[messages.length - 1].imageUrl)\n        ) {\n          messageReceivedAudio.play();\n        } else if (\n          messages[messages.length - 1].uid === user.uid &&\n          !paginating2.current &&\n          (messages[messages.length - 1].imageUrl === \"uploading\" ||\n            !messages[messages.length - 1].imageUrl) &&\n          (messages[messages.length - 1].audioUrl === \"uploading\" ||\n            !messages[messages.length - 1].audioUrl)\n        ) {\n          messageSentAudio.play();\n        }\n      }\n    }\n  }, [messages, deleting, dispatchMessages[roomID]]);\n\n  useEffect(() => {\n    if (firstRender && !limitReached) {\n      chatBodyContainer.current.addEventListener(\"scroll\", paginate);\n    }\n    const clean = chatBodyContainer.current;\n    return () => {\n      clean.removeEventListener(\"scroll\", paginate);\n    };\n  }, [firstRender, limitReached]);\n\n  useEffect(\n    () => {\n      if (limitReached !== dispatchMessages[roomID]?.limitReached) {\n        //console.log(\"setting limit reached: \", Boolean(dispatchMessages[roomID]?.limitReached));\n        setLimitReached(Boolean(dispatchMessages[roomID]?.limitReached));\n      }\n    },\n    [dispatchMessages[roomID]],\n    limitReached\n  );\n\n  useLayoutEffect(() => {\n    //console.log(\"paginating: \", paginating.current)\n    if (messages.length > 0 && paginating.current) {\n      if (\n        paginating.current &&\n        messages.length > prevMessages.current?.length\n      ) {\n        chatBodyContainer.current.scrollTop =\n          chatBodyContainer.current.scrollHeight - prevScrollHeight.current;\n        paginating.current = false;\n        setPaginateLoader(false);\n      }\n    }\n  }, [messages]);\n\n  useEffect(() => {\n    if (messages.length > 0) {\n      if (\n        !firstRender &&\n        chatBodyContainer.current.scrollHeight -\n          chatBodyContainer.current.offsetHeight !==\n          0\n      ) {\n        chatBodyContainer.current.scrollTop =\n          chatBodyContainer.current.scrollHeight;\n        setTimeout(() => {\n          const node = document.querySelector(\".chat .chat__lastMessage\");\n          if (node) {\n            node.style.animation = \"none\";\n            node.style.opacity = \"1\";\n          }\n          setTimeout(() => {\n            setFirstRender(true);\n          }, 200);\n        }, 50);\n      } else {\n        //console.log(\"messages: \", messages);\n        //console.log(\"previous messages: \", prevMessages.current);\n        //console.log(\"paginating2: \", paginating2.current)\n        if (!paginating2.current) {\n          scrollChatBody();\n        }\n      }\n    }\n  }, [messages]);\n\n  function listenToImg(docID) {\n    return db\n      .collection(\"rooms\")\n      .doc(roomID)\n      .collection(\"messages\")\n      .doc(docID)\n      .onSnapshot((doc) => {\n        //console.log(\"image snap set\");\n        //console.log(\"image data: \", doc.data());\n        const { imageUrl } = doc.data();\n        if (imageUrl !== \"uploading\") {\n          //console.log(\"dispatching the image\");\n          dispatch({\n            type: \"update_media\",\n            roomID: roomID,\n            id: docID,\n            data: { imageUrl },\n          });\n          //console.log(\"unsubscribing from image snap: \", docID);\n          mediaSnap.current = mediaSnap.current.filter((cur) => {\n            if (cur.id !== docID) {\n              return true;\n            }\n            cur.snap();\n            return false;\n          });\n        }\n      });\n  }\n\n  function listenToAudio(docID) {\n    //console.log(\"listen to audio function\")\n    const s = db\n      .collection(\"rooms\")\n      .doc(roomID)\n      .collection(\"messages\")\n      .doc(docID)\n      .onSnapshot((doc) => {\n        //console.log(\"audio snap set\");\n        //console.log(\"audio data: \", doc.data());\n        const { audioUrl, audioPlayed } = doc.data();\n        if (audioUrl !== \"uploading\" || audioPlayed === true) {\n          //console.log(\"dispatching audio\");\n          dispatch({\n            type: \"update_media\",\n            roomID: roomID,\n            id: docID,\n            data: {\n              audioUrl,\n              audioPlayed,\n            },\n          });\n        }\n        if (audioUrl !== \"uploading\" && audioPlayed === true) {\n          //console.log(\"unsubscribing from audio snap: \", docID);\n          mediaSnap.current = mediaSnap.current.filter((cur) => {\n            if (cur.id !== docID) {\n              return true;\n            }\n            cur.snap();\n            return false;\n          });\n        }\n      });\n    return s;\n  }\n\n  useEffect(() => {\n    return () => {\n      dispatch({ type: \"set_audio_false\", id: roomID });\n    };\n  }, [roomID]);\n\n  useEffect(() => {\n    if (messages.length > 0 && firstRender && !mediaChecked.current) {\n      //console.log(\"checking media\");\n      messages.forEach((cur) => {\n        if (cur.imageUrl === \"uploading\") {\n          //console.log(\"listening to an image\");\n          const x = listenToImg(cur.id);\n          mediaSnap.current.push({\n            snap: x,\n            id: cur.id,\n          });\n        } else if (cur.audioUrl === \"uploading\" || cur.audioPlayed === false) {\n          //console.log(\"listening to audio\");\n          const x = listenToAudio(cur.id);\n          mediaSnap.current.push({\n            snap: x,\n            id: cur.id,\n          });\n        }\n      });\n      mediaChecked.current = true;\n    } else if (\n      messages.length > prevMessages.current.length &&\n      firstRender &&\n      mediaChecked.current\n    ) {\n      //console.log(\"checking updates\")\n      let init = 0;\n      let stop = messages.length - prevMessages.length;\n      if (prevMessages.current[0]?.id === messages[0].id) {\n        init = prevMessages.current.length;\n        stop = messages.length;\n      }\n      for (var i = init; i < stop; i++) {\n        if (messages[i].imageUrl === \"uploading\") {\n          //console.log(\"listening to an image\");\n          const x = listenToImg(messages[i].id);\n          mediaSnap.current.push({\n            snap: x,\n            id: messages[i].id,\n          });\n        } else if (\n          messages[i].audioUrl === \"uploading\" ||\n          messages[i].audioPlayed === false\n        ) {\n          //console.log(\"listening to audio\");\n          const x = listenToAudio(messages[i].id);\n          mediaSnap.current.push({\n            snap: x,\n            id: messages[i].id,\n          });\n        }\n      }\n    }\n  }, [messages, firstRender]);\n\n  useEffect(() => {\n    return () => {\n      //console.log(\"cleaning media snap\");\n      mediaSnap.current.forEach((cur) => cur.snap());\n      setFirstRender(false);\n    };\n  }, [roomID]);\n\n  useEffect(() => {\n    paginating2.current = paginating.current;\n    prevMessages.current = [...messages];\n  }, [messages]);\n\n  useEffect(() => {\n    if (roomID && !deleting) {\n      if (b.current[roomID]) {\n        //console.log(\"snapshot listener already exists\");\n        b.current[roomID]();\n      }\n      //console.log(\"first message from fetch effect: \", dispatchMessages[roomID]?.firstMessageID);\n      if (dispatchMessages[roomID]?.firstMessageID) {\n        fetchMessages(true);\n      } else {\n        db.collection(\"rooms\")\n          .doc(roomID)\n          .collection(\"messages\")\n          .orderBy(\"timestamp\", \"asc\")\n          .limit(1)\n          .get()\n          .then((docs) => {\n            //console.log(\"doc: \", docs);\n            if (docs.empty) {\n              dispatch({\n                type: \"set_firstMessage\",\n                id: roomID,\n                firstMessageID: \"no id\",\n              });\n            } else {\n              docs.forEach((doc) => {\n                //console.log(\"doc.exists: \", doc.exists);\n                //console.log(\"first document id: \", doc.id);\n                //console.log(\"first document data: \", doc.data());\n                dispatch({\n                  type: \"set_firstMessage\",\n                  id: roomID,\n                  firstMessageID: doc.id,\n                });\n              });\n            }\n            fetchMessages(false);\n            fetchMessages(true);\n          });\n      }\n    }\n  }, [roomID, deleting]);\n\n  useEffect(() => {\n    if (src !== \"\") {\n      const width = document.querySelector(\".mediaPreview img\").clientWidth;\n      const height = document.querySelector(\".mediaPreview img\").clientHeight;\n      setRatio(height / width);\n    }\n  }, [src]);\n\n  useEffect(() => {\n    setClientWidth(\n      document.querySelector(\".chat__body--container\").clientWidth\n    );\n  }, []);\n  //window\n  useEffect(() => {\n    if (animState === \"entering\" && page.width <= 160) {\n      setTimeout(() => {\n        document.querySelector(\".chat\").classList.add(\"chat-animate\");\n      }, 0);\n    } else if (animState === \"entered\" && state?.name && page.width <= 760) {\n      setTimeout(() => {\n        document.querySelector(\".sidebar\").classList.remove(\"side\");\n      }, 50);\n    } else if (animState === \"exiting\" && page.width <= 160) {\n      setTimeout(() => {\n        document.querySelector(\".chat\").classList.remove(\"chat-animate\");\n        setTimeout(() => {\n          document.querySelector(\".sidebar\").classList.add(\"side\");\n        }, 10);\n      }, 0);\n    }\n  }, [animState]);\n\n  useEffect(() => {\n    if (!location.state && roomID) {\n      const userID = roomID?.replace(user.uid, \"\");\n      db.collection(\"users\")\n        .doc(userID)\n        .get()\n        .then((doc) => {\n          const data = doc.data();\n          setState(\n            data?.name\n              ? {\n                  name: data.name,\n                  photoURL: data.photoURL,\n                  userID,\n                }\n              : {\n                  userID,\n                }\n          );\n        });\n    } else {\n      setState(location.state);\n    }\n  }, [location.state, roomID]);\n\n  useEffect(() => {\n    if (state?.userID) {\n      db.collection(\"users\")\n        .doc(state.userID)\n        .onSnapshot((doc) => {\n          if (doc.data()?.token) {\n            setToken(doc.data().token);\n          }\n        });\n    }\n  }, [state]);\n\n  useEffect(() => {\n    if (roomID && state?.userID) {\n      var h = db\n        .collection(\"rooms\")\n        .doc(roomID)\n        .onSnapshot((snap) => {\n          if (snap.data()) {\n            setTyping(snap.data()[state.userID]);\n          }\n        });\n    }\n\n    return () => {\n      if (h) h();\n    };\n  }, [roomID, state]);\n\n  useEffect(() => {\n    if (roomID) {\n      var z = db\n        .collection(\"rooms\")\n        .doc(roomID)\n        .onSnapshot((snap) => {\n          setSeen(snap.data()?.seen);\n        });\n    }\n\n    return () => {\n      if (z) {\n        z();\n      }\n    };\n  }, [roomID]);\n\n  //setSender\n  //window\n  useEffect(() => {\n    var a = () => {\n      const nodeArr = Array.from(document.querySelectorAll(\".chat__message\"));\n      const height =\n        outerHeight(nodeArr[nodeArr.length - 1]) +\n        outerHeight(nodeArr[nodeArr.length - 2]) +\n        outerHeight(nodeArr[nodeArr.length - 3]) +\n        outerHeight(nodeArr[nodeArr.length - 4]);\n      const lastMHeight = height < page.height / 2 ? height : page.height / 2;\n      if (\n        chatBodyContainer.current?.scrollTop <=\n        chatBodyContainer.current?.scrollHeight -\n          chatBodyContainer.current?.offsetHeight -\n          lastMHeight\n      ) {\n        setScrollArrow(true);\n      } else {\n        setScrollArrow(false);\n      }\n      const scrollTop = Math.round(chatBodyContainer.current.scrollTop);\n      const scrollHeight =\n        chatBodyContainer.current.scrollHeight -\n        chatBodyContainer.current.offsetHeight;\n      if (\n        (scrollTop === scrollHeight ||\n          scrollTop + 1 === scrollHeight ||\n          scrollTop - 1 === scrollHeight) &&\n        (chatBodyRef.current.style.opacity === \"0\" ||\n          chatBodyRef.current.style.opacity === \"\")\n      ) {\n        setTimeout(\n          () => {\n            if (chatBodyRef.current) {\n              chatBodyRef.current.style.opacity = \"1\";\n            }\n          },\n          animState === \"entering\" ? 350 : 50\n        );\n      }\n      if (messages.length > 0) {\n        if (\n          chatBodyContainer.current.scrollTop >\n            chatBodyContainer.current.scrollHeight -\n              chatBodyContainer.current.offsetHeight -\n              180 &&\n          state.userID &&\n          !seen &&\n          messages[messages.length - 1].uid !== user.uid\n        ) {\n          console.log(\"setting seen true with event\");\n          db.collection(\"rooms\").doc(roomID).set(\n            {\n              seen: true,\n            },\n            { merge: true }\n          );\n        }\n        if (\n          chatBodyContainer.current.scrollTop >\n            chatBodyContainer.current.scrollHeight -\n              chatBodyContainer.current.offsetHeight -\n              180 &&\n          state.userID\n        ) {\n          db.collection(\"users\")\n            .doc(user.uid)\n            .collection(\"chats\")\n            .doc(roomID)\n            .set(\n              {\n                unreadMessages: 0,\n              },\n              { merge: true }\n            );\n        }\n      }\n    };\n    chatBodyContainer.current.addEventListener(\"scroll\", a);\n    const ref = chatBodyContainer.current;\n\n    return () => {\n      ref.removeEventListener(\"scroll\", a);\n    };\n  }, [messages, state, user.uid, roomID, seen]);\n\n  //setting seen and unreadMessages when chat is unscrollable\n  useEffect(() => {\n    if (messages.length > 0) {\n      if (\n        chatBodyContainer.current.scrollHeight -\n          chatBodyContainer.current.offsetHeight ===\n          0 &&\n        messages[messages.length - 1].uid !== user.uid\n      ) {\n        db.collection(\"rooms\").doc(roomID).set(\n          {\n            seen: true,\n          },\n          { merge: true }\n        );\n      }\n    }\n  }, [messages]);\n\n  useEffect(() => {\n    if (messages.length > 0) {\n      if (\n        chatBodyContainer.current.scrollHeight -\n          chatBodyContainer.current.offsetHeight ===\n          0 &&\n        state.userID\n      ) {\n        db.collection(\"users\")\n          .doc(user.uid)\n          .collection(\"chats\")\n          .doc(roomID)\n          .set(\n            {\n              unreadMessages: 0,\n            },\n            { merge: true }\n          );\n      }\n    }\n  }, [messages, state]);\n\n  useEffect(() => {\n    if (dispatchMessages[roomID]?.messages) {\n      setMessages(dispatchMessages[roomID].messages);\n    }\n  }, [dispatchMessages[roomID]]);\n\n  //window\n  const widthRatio = 0.7;\n\n  return (\n    <>\n      <div\n        style={!roomID ? { display: \"none\" } : {}}\n        ref={chatAnim}\n        className=\"chat\"\n      >\n        {/* <p>Chat.js</p>*/}\n        <div\n          style={{\n            height: page.height,\n          }}\n          className=\"chat__background\"\n        ></div>\n        <div className=\"chat__header\">\n          {page.width <= 760 ? (\n            <IconButton onClick={() => setTimeout(() => history.goBack(), 150)}>\n              <ArrowBack />\n              <div className=\"avatar__container\">\n                <Avatar src={state?.photoURL} />\n                {roomsData[roomID]?.onlineState === \"online\" ? (\n                  <div className=\"online\"></div>\n                ) : null}\n              </div>\n            </IconButton>\n          ) : (\n            <div className=\"avatar__container\">\n              <Avatar src={state?.photoURL} />\n              {roomsData[roomID]?.onlineState === \"online\" ? (\n                <div className=\"online\"></div>\n              ) : null}\n            </div>\n          )}\n          <div className=\"chat__header--info\">\n            <h3 style={page.width <= 160 ? { width: page.width - 265 } : {}}>\n              {state?.name}{\" \"}{state?.about}{\" \"}{state?.phone}\n            </h3>\n            <p style={page.width <= 160 ? { width: page.width - 165 } : {}}>\n              {typing === \"recording\"\n                ? \"Записывается ...\"\n                : typing\n                ? \"Пишет ...\"\n                : messages?.length > 0\n                ? \"Просмотрено \" + messages[messages.length - 1]?.timestamp\n                : \"\"}{\" \"}\n            </p>\n          </div>\n\n          <div className=\"chat__header--right\">\n            <input\n              id=\"attach-media\"\n              style={{ display: \"none\" }}\n              accept=\"image/*\"\n              type=\"file\"\n              onChange={handleFile}\n            />\n            <IconButton>\n              <label\n                style={{ cursor: \"pointer\", height: 24 }}\n                htmlFor=\"attach-media\"\n              >\n                <AddPhotoAlternate />\n              </label>\n            </IconButton>\n\n            <IconButton\n              aria-controls=\"menu\"\n              aria-haspopup=\"true\"\n              onClick={(event) => setOpenMenu(event.currentTarget)}\n            >\n              <MoreVert />\n            </IconButton>\n\n            <Menu\n              anchorEl={openMenu}\n              id={\"menu\"}\n              open={Boolean(openMenu)}\n              onClose={() => setOpenMenu(null)}\n              keepMounted\n            >\n              <MenuItem onClick={deleteRoom}>\n                <Delete /> Удалить все сообщения\n              </MenuItem>\n              <MenuItem\n                onClick={() => {\n                  auth.signOut();\n                  db.doc(\"/users/\" + user.uid).set(\n                    { state: \"offline\" },\n                    { merge: true }\n                  );\n                  history.replace(\"/chats\");\n                  setTimeout(() => {\n                    window.location.reload();\n                  }, 1000);\n                }}\n              >\n                <LogOut /> Выйти\n              </MenuItem>\n              <MenuItem\n                onClick={() => {\n                     auth.signOut();\n                  db.doc(\"/users/\" + user.uid).set(\n                    { state: \"offline\" },\n                    { merge: true }\n                  );\n                   history.replace(\"/chats\");\n                      setTimeout(() => {\n                       window.location.reload();\n                    }, 1000);\n                }}\n              >\n                <VisibilityOff /> Выйти в оффлайн\n              </MenuItem>\n            </Menu>\n          </div>\n        </div>\n\n        <div className=\"chat__body--container\" ref={chatBodyContainer}>\n          <div className=\"chat__body\" ref={chatBodyRef}>\n            <div\n              className=\"loader__container paginateLoader\"\n              style={{\n                height: !limitReached ? 70 : 30,\n              }}\n            >\n              {paginateLoader && !limitReached ? <CircularProgress /> : null}\n            </div>\n            {messages.map((message, i, messageArr) => {\n              const style = message.imageUrl\n                ? {\n                    marginBottom: !messageArr[i + 1]\n                      ? 0\n                      : message.uid !== messageArr[i + 1].uid\n                      ? 30\n                      : 8,\n                    width: clientWidth * widthRatio + 20,\n                    maxWidth: 320,\n                  }\n                : {\n                    marginBottom: !messageArr[i + 1]\n                      ? 0\n                      : message.uid !== messageArr[i + 1].uid\n                      ? 30\n                      : 8,\n                    width: clientWidth * widthRatio + 20,\n                    maxWidth: 320,\n                  };\n              return (\n                <div\n                  style={style}\n                  ref={\n                    i === messages.length - 1 &&\n                    !(seen && messages[messages.length - 1].uid === user.uid)\n                      ? lastMessageRef\n                      : null\n                  }\n                  key={message.id}\n                  className={`chat__message ${\n                    message.uid === user.uid && \"chat__reciever\"\n                  } ${i === messages.length - 1 ? \"chat__lastMessage\" : \"\"}`}\n                >\n                  <span className=\"chat__name\">{message.name}</span>\n                  {message.imageUrl === \"uploading\" ? (\n                    <div\n                      style={{\n                        width: clientWidth * widthRatio,\n                        height:\n                          message.ratio <= 1\n                            ? clientWidth * widthRatio > 300\n                              ? 300 * message.ratio\n                              : clientWidth * widthRatio * message.ratio\n                            : clientWidth * widthRatio < 300\n                            ? clientWidth * widthRatio\n                            : 300,\n                      }}\n                      className=\"image-container\"\n                    >\n                      <div className=\"image__container--loader\">\n                        <CircularProgress\n                          style={{\n                            width: page.width <= 760 ? 40 : 80,\n                            height: page.width <= 760 ? 40 : 80,\n                          }}\n                        />\n                      </div>\n                    </div>\n                  ) : message.imageUrl ? (\n                    <div\n                      className=\"image-container\"\n                      style={{\n                        width: clientWidth * widthRatio,\n                        height:\n                          message.ratio <= 1\n                            ? clientWidth * widthRatio > 300\n                              ? 300 * message.ratio\n                              : clientWidth * widthRatio * message.ratio\n                            : clientWidth * widthRatio < 300\n                            ? clientWidth * widthRatio\n                            : 300,\n                      }}\n                    >\n                      <Link\n                        to={{\n                          pathname: match.url + \"/image\",\n                          state: state,\n                        }}\n                      >\n                        <img\n                          onClick={(e) =>\n                            clickImagePreview(\n                              e,\n                              message.imageUrl,\n                              message.ratio\n                            )\n                          }\n                          src={message.imageUrl}\n                          alt=\"\"\n                        />\n                      </Link>\n                    </div>\n                  ) : null}\n                  {message.audioName ? (\n                    <AudioPlayer\n                      sender={message.uid === user.uid}\n                      roomID={roomID}\n                      animState={animState}\n                      setAudioID={setAudioID}\n                      audioID={audioID}\n                      id={message.id}\n                      audioUrl={message.audioUrl}\n                      audioPlayed={message.audioPlayed}\n                    />\n                  ) : (\n                    <span className=\"chat__message--message\">\n                      {message.message}\n                    </span>\n                  )}\n                  <span className=\"chat__timestamp\">{message.timestamp}</span>\n                </div>\n              );\n            })}\n            {messages.length > 0 ? (\n              <CSSTransition\n                in={seen && messages[messages.length - 1].uid === user.uid}\n                timeout={200}\n                classNames=\"seen-animate\"\n                appear={true}\n              >\n                <p className=\"seen\">\n                  <p>\n                    <span>\n                      Просмотрено <DoneAllRounded />\n                    </span>\n                  </p>\n                </p>\n              </CSSTransition>\n            ) : null}\n          </div>\n        </div>\n        {src !== \"\" ? (\n          <MediaPreview\n            close={close}\n            mediaPreview={mediaPreview}\n            setSRC={setSRC}\n            setImage={setImage}\n            imageSRC={src}\n          />\n        ) : null}\n\n        <ChatFooter\n          input={input}\n          handleFocus={handleFocus}\n          change={change}\n          sendMessage={sendMessage}\n          setFocus={setFocus}\n          image={image}\n          focus={focus}\n          state={state}\n          token={token}\n          roomID={roomID}\n          setAudioID={setAudioID}\n        />\n        <div></div>\n\n        <CSSTransition\n          in={firstRender && scrollArrow && !sendAnim}\n          classNames=\"scroll\"\n          timeout={310}\n          unmountOnExit\n        >\n          <div\n            className=\"scroll\"\n            onClick={() =>\n              anime({\n                targets: chatBodyContainer.current,\n                scrollTop: chatBodyContainer.current.scrollHeight,\n                duration: 1000,\n                easing: \"linear\",\n              })\n            }\n          >\n            <ArrowDownward\n              style={{\n                width: 22,\n                height: 22,\n                color: \"black\",\n              }}\n            />\n            {unreadMessages ? (\n              <div>\n                <span>{unreadMessages}</span>\n              </div>\n            ) : null}\n          </div>\n        </CSSTransition>\n        {deleting ? (\n          <div className=\"chat__deleting\">\n            <CircularProgress />\n          </div>\n        ) : null}\n      </div>\n      <TransitionGroup component={null}>\n        <Transition\n          timeout={{\n            appear: 310,\n            enter: 310,\n            exit: 410,\n          }}\n          classNames=\"page\"\n          key={location.pathname}\n        >\n          {(animState) => (\n            <Route path={match.url + \"/image\"} location={location}>\n              <ImagePreview imagePreview={imagePreview} animState={animState} />\n            </Route>\n          )}\n        </Transition>\n      </TransitionGroup>\n    </>\n  );\n}\n\nexport default memo(Chat);\n","import {memo} from 'react';\nimport { Button } from '@material-ui/core';\nimport { auth, provider } from './firebase';\nimport './Login.css'\n\nimport YourRole from \"./YourRole\";\n\n\nfunction Login() {\n    const signIn = () => {\n        auth.signInWithRedirect(provider).catch(e => alert(e.message))\n    }\n\n    return (\n        <div className=\"login\">\n             <div className=\"nono\"> <YourRole /></div>\n            <div className=\"login__container\">\n                <img\n                    src=\"/logo.png\"\n                    alt=\"UberClone\"\n                />\n                <div className=\"login__text\">\n                    <h1>Войдите в UberClone</h1>\n                </div>\n\n                <Button onClick={signIn}>\n                    вместе с Гугл\n                </Button>\n            </div>\n        </div>\n    )\n}\n\nexport default memo(Login)","import { useRef, useState } from \"react\";\n\nexport default function useFetchData(limitNumber, get,initCount, snapHandler, name) {\n\tconst limit = useRef(0);\n\tconst dataUnsub = useRef();\n\tconst [data, setData] = useState(null);\n\tconst snapCount = useRef(0);\n\n\treturn [data, function fetchData(setScrollFetch) {\n\t\tif (limit.current || limit.current === 0) {\n            if (limit.current === \"limit attended\") {\n                setScrollFetch(false);\n                limit.current = null;\n            } else {\n                setScrollFetch(true);\n                limit.current = limit.current + limitNumber;\n            };\n            if (dataUnsub.current) {\n                dataUnsub.current();\n            };\n            if (initCount) {\n            \tsnapCount.current = 0;\n            };\n            let timeout = null;\n            const getData = limit.current ? get.limit(limit.current) : get;\n            dataUnsub.current = getData.onSnapshot(snapshot => {\n                snapCount.current++;\n                const s = () => {\n                    const arr = snapHandler(snapshot);\n                    setData(arr);\n                    setScrollFetch(false);\n                    if ((name === \"users\" && arr.length < limit.current - 1) || (name !== \"users\" && arr.length < limit.current)) {\n                        limit.current = \"limit attended\";\n                        fetchData(setScrollFetch)\n                    };\n                };\n                if (snapshot.docs?.length > 0) {\n                    if (snapCount.current >= 2) {\n                    \tif (timeout) {\n                    \t\tclearTimeout(timeout);\n                    \t\ttimeout = null;\n                    \t}\n                    \ts();\n                    } else {\n                    \ttimeout = setTimeout(s, 1500)\n                    };\n                } else if (snapshot.docs?.length === 0) {\n                    setData([]);\n                    setScrollFetch(false);\n                };\n            });\n        };\n        return dataUnsub;\n\t}, setData];\n};","import React, {useState, useEffect} from 'react';\r\n  \r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Collapse from '@material-ui/core/Collapse';\r\nimport Button from '@material-ui/core/Button';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport * as axios from 'axios';\r\n\r\nimport {makeStyles} from '@material-ui/core/styles';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    width: '100%',\r\n    '& > * + *': {\r\n      marginTop: theme.spacing(2),\r\n    },\r\n   // height: Dimensions.get('window').height - 400\r\n  },\r\n  \r\n}));\r\n\r\nconst UberTypes = (props) => { \r\n  const classes = useStyles();\r\n  const [cart, setCart] = React.useState(false);\r\n  const [carterr, setCarterr] = React.useState(false);\r\n  const [open, setOpen] = React.useState(false);\r\n  const [dist, setOpendist] = React.useState();\r\n\r\n  const putCart = async () => {\r\n    try {\r\n      const cartData = await axios\r\n        .get(  \r\n          //&=${getCarr} в конец след строки вставить, если нужны\r\n          //  cartreact&searchcar=${getCarr}\r\n          `https://taxi.bigdatamicrodata.pp.ua/index.php?route=api/cartreact/add`,\r\n        )\r\n        .then((response) => {\r\n          setCart(true);\r\n          console.log(response);\r\n        });\r\n    } catch (e) {\r\n      setCarterr(true);\r\n      console.log(e);\r\n    }\r\n  };\r\n  // putCart();\r\n\r\n  return (\r\n    <div className={classes.root} >  \r\n     <Collapse\r\n        in={carterr}\r\n        style={{\r\n          cursor: 'pointer',\r\n          backgroundColor: 'red',\r\n        }}>\r\n        <Alert\r\n          style={{\r\n            cursor: 'pointer',\r\n            backgroundColor: 'red',\r\n            color:\"inherit\"\r\n          }}\r\n          action={\r\n            <IconButton\r\n              aria-label=\"close\"\r\n              color=\"inherit\"\r\n              size=\"small\"\r\n              onClick={() => {\r\n                setCarterr(false);\r\n              }}>\r\n              <CloseIcon   />\r\n            </IconButton>\r\n          }>\r\n          Возможно что-то с интернетом, ваша заявка не проходит, попробуйте еще\r\n          раз \r\n        </Alert>\r\n      </Collapse>\r\n       <Collapse\r\n        in={cart}\r\n        style={{\r\n          cursor: 'pointer',\r\n          backgroundColor: 'blue',\r\n        }}>\r\n        <Alert\r\n          action={\r\n            <IconButton\r\n              aria-label=\"close\"\r\n              color=\"inherit\"\r\n              size=\"small\"\r\n              onClick={() => {\r\n                setCart(false);\r\n              }}>\r\n              <CloseIcon />\r\n            </IconButton>\r\n          }>\r\n          Ваша заявка подана и будет висеть на доске обьявлений в течении часа.\r\n          <IconButton\r\n              aria-label=\"menu\"\r\n              color=\"inherit\"\r\n              size=\"small\"\r\n              onClick={(e) => {\r\n           //     navigation.navigate('OrderPage');\r\n              }}> \r\n               Нажмите чтобы отслеживать.\r\n            </IconButton>\r\n        </Alert>\r\n      </Collapse>\r\n      <Collapse\r\n        in={open}\r\n        style={{\r\n          cursor: 'pointer',\r\n        }}>\r\n        <Alert\r\n          action={\r\n            <IconButton\r\n              aria-label=\"close\"\r\n              color=\"inherit\"\r\n              size=\"small\"\r\n              onClick={() => {\r\n                setOpen(false);\r\n              }}>\r\n              <CloseIcon  />\r\n            </IconButton>\r\n          }>\r\n          {dist} {' '}\r\n          <IconButton\r\n            onClick={() => {\r\n              putCart();\r\n            }}>\r\n            Подтвердить\r\n          </IconButton>\r\n        </Alert>\r\n      </Collapse> \r\n      {/* {typesData.map((type) => (\r\n        <UberTypeRow type={type} key={type.id}  \r\n        onClick={(e) => {\r\n          localStorage.setItem('UberTypeRow', type.id) \r\n          navigation.navigate('Home')\r\n        }}  \r\n         \r\n        />\r\n      ))} \r\n      <Button\r\n        style={{\r\n          flex: 1,\r\n          backgroundColor: 'black',\r\n          color: 'white',\r\n          padding: 10,\r\n          margin: 10,\r\n          alignItems: 'center',\r\n          cursor: 'pointer',\r\n        }}\r\n        disabled={open}\r\n        variant=\"outlined\"\r\n        onClick={() => {\r\n          setOpen(true);\r\n          setOpendist(localStorage.getItem('distance'));\r\n        }}>\r\n        Оставить заявку для всех\r\n      </Button>*/}\r\n    </div>\r\n  );\r\n};\r\nexport default UberTypes;\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\n\r\nimport Button from \"@material-ui/core/Button\";\r\n//import {Image, Text, View, Alert} from 'react-native';\r\n//import {useRoute, useNavigation} from '@react-navigation/native';\r\nimport { NavLink, Route, useHistory, Switch } from \"react-router-dom\";\r\nimport * as axios from \"axios\";\r\nimport {\r\n  YMaps,\r\n  Map,\r\n  Placemark,\r\n  RouteButton,\r\n  GeolocationControl,\r\n  RoutePanel,\r\n} from \"react-yandex-maps\";\r\n\r\nimport DrawerLeft from \"./DrawerLeft\";\r\nimport \"./App.css\";\r\nimport db, {\r\n  auth,\r\n  storage1,\r\n  provider,\r\n  createTimestamp,\r\n  messaging,\r\n} from \"./firebase\";\r\nimport firebase from \"firebase/app\";\r\n\r\nimport UberTypes from \"./UberTypes\";\r\n\r\nconst options = {\r\n  suppressMapOpenBlock: true,\r\n};\r\n\r\nnavigator.geolocation.getCurrentPosition(function (position) {\r\n  // Текущие координаты.\r\n  let lat = position.coords.latitude;\r\n  let lng = position.coords.longitude;\r\n  let gps = lat + \", \" + lng;\r\n\r\n  localStorage.setItem(\"lat\", lat);\r\n  localStorage.setItem(\"lng\", lng);\r\n  localStorage.setItem(\"gps\", gps);\r\n  let accuracy = position.coords.accuracy;\r\n  localStorage.setItem(\"accuracy\", accuracy);\r\n  // console.log(\"lat доступна \" + lat); // Геолокация доступна\r\n  // console.log(\"lng доступна \" + lng); // Геолокация доступна\r\n  // console.log(\"accuracy доступна \" + accuracy); // Погрешность\r\n});\r\nlet lati = localStorage.getItem(\"lat\");\r\nlet lngi = localStorage.getItem(\"lng\");\r\nvar gpsi = localStorage.getItem(\"gps\");\r\nconst mapState = { center: [lati, lngi], zoom: 12 };\r\nconsole.log(\"gps DestinationSearch \" + gpsi);\r\n\r\nconst DestinationSearch = (props) => {\r\n  let history = useHistory();\r\n  console.log(\"props\", props);\r\n  //\tdebugger;\r\n\r\n  const navigatorGeolocation = () => {\r\n    console.log('geo');\r\n    navigator.geolocation.getCurrentPosition(function (position) {\r\n      // Текущие координаты.\r\n      let lat = position.coords.latitude;\r\n      let lng = position.coords.longitude;\r\n      let gps = lat + \", \" + lng;\r\n\r\n      localStorage.setItem(\"lat\", lat);\r\n      localStorage.setItem(\"lng\", lng);\r\n      localStorage.setItem(\"gps\", gps);\r\n      let accuracy = position.coords.accuracy;\r\n      localStorage.setItem(\"accuracy\", accuracy);\r\n     // npm i -g androidjs-builder\r\n      // console.log(\"lat доступна \" + lat); // Геолокация доступна\r\n      // console.log(\"lng доступна \" + lng); // Геолокация доступна\r\n      // console.log(\"accuracy доступна \" + accuracy); // Погрешность\r\n    });\r\n  };\r\n\r\n  const [drawerLeft, setDrawerLeft] = useState(false);\r\n  const [setMap, setMapOpen] = useState(\"0.5\");\r\n  const [setMapf, setMapOpenf] = useState(\"invert(1)\");\r\n  const [open, setOpen] = React.useState(false);\r\n  console.log(setMap);\r\n  const handleDrawerLeftOpen = () => {\r\n    //   setMenuSidebar(null);\r\n    setDrawerLeft(true);\r\n  };\r\n\r\n  const handleMapOpen = () => {\r\n    //   setMenuSidebar(null);\r\n    setMapOpen(\"1\");\r\n    setMapOpenf(\"hue-rotate(45deg)\");\r\n  };\r\n  // console.log(props);\r\n  const typeState = useState(null);\r\n\r\n  //const route = useRoute();\r\n  //const navigation = useNavigation();\r\n\r\n  const onSubmit = async () => {\r\n    const [type] = typeState;\r\n    if (!type) {\r\n      return;\r\n    }\r\n\r\n    //console.log('onSubmit 55555555');\r\n    // submit to server\r\n    /*  try {\r\n      //\tconst userInfo = await Auth.currentAuthenticatedUser();\r\n\r\n      const date = new Date();\r\n      const input = {\r\n        createdAt: \"\",\r\n        type,\r\n        originLatitude: localStorage.getItem(\"distance\"),\r\n        oreiginLongitude: localStorage.getItem(\"distance\"),\r\n\r\n        destLatitude: localStorage.getItem(\"distance\"),\r\n        destLongitude: localStorage.getItem(\"distance\"),\r\n\r\n        userId: 1,\r\n        carId: \"1\",\r\n        status: \"NEW\",\r\n      };\r\n\r\n          Alert.alert(\r\n\t\t\t\t(title = 'Ура!'),\r\n\t\t\t\t(message = 'Вы заказали авто!'),\r\n\t\t\t\t(buttons = [\r\n\t\t\t\t{\r\n\t\t\t\ttext: 'Перейти на главную',\r\n\t\t\t\tonPress: () => navigation.navigate('Home'),\r\n\t\t\t\t},\r\n\t\t\t\t]),\r\n\t\t\t); \r\n      //  navigation.navigate('OrderPage', { id: response.data.createOrder.id });\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    */\r\n  };\r\n  if (localStorage.getItem(\"userName\") === null) {\r\n    localStorage.setItem(\"userName\", \" залогиньтесь\");\r\n  }\r\n  const [cars, setCars] = useState([]);\r\n  const [carsfire, setCarsfire] = useState(props.users);\r\n  //console.log(\"carsfire\", carsfire);\r\n  //console.log(\"cars\", cars);\r\n  console.log(\"props.users\", props.users);\r\n  //props.users\r\n  const [orderRoute, setOrderRoute] = useState([]);\r\n\r\n  /*\r\n  useEffect(() => {\r\n    const fetchCars = async (getCarr) => {\r\n      try {\r\n        const usersData = await axios\r\n          .get(\r\n            `https://taxi.bigdatamicrodata.pp.ua/index.php?route=api/searchcar&searchcar=${getCarr}`\r\n          )\r\n          .then((response) => {\r\n            setCars(response.data.items);\r\n            console.log(response.data.items);\r\n          });\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n    };\r\n    fetchCars(\"\");\r\n  }, []);\r\n  */\r\n\r\n  //  console.log('props 55555555');\r\n  return (\r\n    <div className=\"dest\">\r\n      <div\r\n        className=\"destb\"\r\n        style={{\r\n          opacity: setMap,\r\n          filter: setMapf,\r\n        }}\r\n      >\r\n        <DrawerLeft\r\n          drawerLeft={drawerLeft}\r\n          setDrawerLeft={setDrawerLeft}\r\n          db={db}\r\n          auth={auth}\r\n          storage={storage1}\r\n        />\r\n        <YMaps\r\n          className=\"destYMaps\"\r\n          // style={{ flex: 1, width: \"100%\", height: \"100%\", margin: 100 }}\r\n          query={{ apikey: \"77344b8e-1d6e-4ba9-be6c-dfe62831be7a\" }}\r\n          //  setMap={setMap}\r\n          //  setMapOpen={setMapOpen}\r\n\r\n          //  style={{ display: \"none\" }}\r\n        >\r\n          <Map\r\n            className=\"destMap\"\r\n            options={options}\r\n            modules={[\"templateLayoutFactory\", \"layout.ImageWithContent\"]}\r\n            state={mapState}\r\n            //    width={\"100%\"}\r\n            //     height={\"70vh\"}\r\n            //  rotate=\"85deg\"\r\n            onApiAvaliable={(ymaps) => this.onApiAvaliable(ymaps)}\r\n          >\r\n            <RouteButton\r\n              instanceRef={(ref) => {\r\n                if (ref) {\r\n                  ref.routePanel.state.set({\r\n                    from: \"\",\r\n                    to: \"\",\r\n                    type: \"auto\",\r\n                  });\r\n                  const obj = ref.routePanel.getRouteAsync();\r\n                  obj\r\n                    .then(function (multiRoute) {\r\n                      multiRoute.model.events.add(\r\n                        \"requestsuccess\",\r\n                        function () {\r\n                          const activeRoute = multiRoute.getActiveRoute();\r\n\r\n                          if (activeRoute) {\r\n                            var activeRoutePaths = activeRoute.getPaths();\r\n                            activeRoutePaths.each(function (path) {\r\n                              // Путь автомобильного маршрута - это\r\n                              // объект multiRouter.driving.Path.\r\n                              // Получение коллекции сегментов в пути.\r\n                              var segments = path.getSegments();\r\n                              // Проход по коллекции сегментов и вывод\r\n                              // информации о каждом сегменте.\r\n                              console.log(segments);\r\n                              var obje = \"\";\r\n                              segments.each(function (segment) {\r\n                                // Вывод информации о сегменте.\r\n                                console.log(\r\n                                  \" Маневр в конце сегмента: \" +\r\n                                    segment.properties.get(\"action\").text\r\n                                );\r\n                                obje +=\r\n                                  \" Маневр в конце сегмента: \" +\r\n                                  segment.properties.get(\"action\").text;\r\n\r\n                                console.log(\r\n                                  \" Длина сегмента: \" +\r\n                                    segment.properties.get(\"distance\").text\r\n                                );\r\n\r\n                                obje +=\r\n                                  \" Длина сегмента: \" +\r\n                                  segment.properties.get(\"distance\").text;\r\n\r\n                                console.log(\r\n                                  \" Время прохождения сегмента: \" +\r\n                                    segment.properties.get(\"duration\").text\r\n                                );\r\n\r\n                                obje +=\r\n                                  \" Время прохождения сегмента: \" +\r\n                                  segment.properties.get(\"duration\").text;\r\n\r\n                                console.log(\r\n                                  \" По какой улице проходит сегмент: \" +\r\n                                    segment.properties.get(\"street\")\r\n                                );\r\n\r\n                                obje +=\r\n                                  \" По какой улице проходит сегмент: \" +\r\n                                  segment.properties.get(\"street\");\r\n                              });\r\n                              console.log(\"obje\", obje);\r\n                              localStorage.setItem(\"obje\", obje);\r\n                            });\r\n\r\n                            const distance =\r\n                              activeRoute.properties.get(\"distance\").text;\r\n                            console.log(\"Длина маршрута: \", distance);\r\n                            console.log(\r\n                              \"Примерное время проезда: \" +\r\n                                activeRoute.properties.get(\"duration\").text\r\n                            );\r\n                            //  setOrderRoute(distance);\r\n                            localStorage.setItem(\r\n                              \"distanceValue\",\r\n                              activeRoute.properties.get(\"distance\").value\r\n                            );\r\n                            localStorage.setItem(\r\n                              \"distance\",\r\n                              \"Расстояние: \" +\r\n                                activeRoute.properties.get(\"distance\").text\r\n                            );\r\n                            localStorage.setItem(\r\n                              \"duration\",\r\n                              \"Примерное время проезда: \" +\r\n                                activeRoute.properties.get(\"duration\").text\r\n                            );\r\n                            console.log(distance);\r\n\r\n                            //   distance=distance;\r\n                            //   duration= activeRoute.properties.get(\"duration\").text;\r\n                            //   db.collection('Trips').doc(id).set({\r\n                            //     distance: distance\r\n                            //   }, { merge: true })\r\n                          }\r\n                        }\r\n                      );\r\n                      return multiRoute;\r\n                    })\r\n                    .then(function () {\r\n                      return obj;\r\n                    })\r\n                    // простое и полезное окончание цепочки промисов:\r\n                    .catch(console.log.bind(console));\r\n                }\r\n              }}\r\n              options={{\r\n                float: \"right\",\r\n                size: \"large\",\r\n                popupWidth: \"210px\",\r\n                maxWidth: \"210px\",\r\n              }}\r\n              state={{\r\n                //    expanded: \"true\", раскрытие блока по умолчанию\r\n                popupWidth: \"210px\",\r\n              }}\r\n            />\r\n\r\n            <GeolocationControl options={{ float: \"left\" }} />\r\n\r\n            <Placemark\r\n              style={{\r\n                width: 10,\r\n                transform: [{ rotate: \"90deg\" }],\r\n              }}\r\n              key=\"fdsdfsdfhghf654gfd\"\r\n              geometry={{\r\n                type: \"Point\",\r\n                //    coordinates: [47.988736, 37.7913344],\r\n                coordinates: [lati, lngi],\r\n              }}\r\n              properties={{\r\n                hintContent: \"я\",\r\n                balloonContent: \"я\",\r\n                iconCaption: \"я\",\r\n                iconImageRotation: 50,\r\n              }}\r\n              modules={[\"geoObject.addon.hint\"]}\r\n              /*   options={{\r\n            //    iconLayout: \"default#image\",\r\n           //     iconImageHref: car.photoURL,\r\n            //    iconImageSize: [74, 61],\r\n            //    iconImageOffset: [-3, -42],\r\n            //    iconImageRotation: 50,\r\n              }}\r\n              onClick={(e) => {\r\n                localStorage.setItem(\"car.name \", car.name);\r\n                //    navigation.navigate('Home');\r\n              }}*/\r\n            />\r\n            {carsfire?.map((car) => (\r\n              <Placemark\r\n                style={{\r\n                  width: 10,\r\n                  transform: [{ rotate: \"90deg\" }],\r\n                }}\r\n                key={car.userID}\r\n                geometry={{\r\n                  type: \"Point\",\r\n                  //  coordinates: [47.988736, 37.7913344],\r\n                  coordinates: [car.latitude, car.longitude],\r\n                }}\r\n                properties={{\r\n                  hintContent: car.name + \" \" + car.about,\r\n                  balloonContent: car.name + \" \" + car.about,\r\n                  iconCaption: car.name + \" \" + car.about,\r\n                  iconImageRotation: 50,\r\n                }}\r\n                modules={[\"geoObject.addon.hint\"]}\r\n                options={{\r\n                  iconLayout: \"default#image\",\r\n                  iconImageHref: car.photoURL,\r\n                  iconImageSize: [74, 61],\r\n                  iconImageOffset: [-3, -42],\r\n                  iconImageRotation: 50,\r\n                }}\r\n                onClick={(e) => {\r\n                  localStorage.setItem(\"car.name \", car.name);\r\n                  localStorage.setItem(\"car.id \", car.userID);\r\n                  history.push(\"/room/\" + car.userID);\r\n                  //    navigation.navigate('Home');\r\n                }}\r\n              />\r\n            ))}\r\n          </Map>\r\n        </YMaps>\r\n      </div>\r\n\r\n      {/*<UberTypes typeState={typeState} onSubmit={onSubmit} />*/}\r\n      <Button\r\n        style={{\r\n          backgroundColor: \"grey\",\r\n          color: \"white\",\r\n          padding: 10,\r\n          margin: 10,\r\n          alignItems: \"center\",\r\n          cursor: \"pointer\",\r\n        }}\r\n        disabled={open}\r\n        variant=\"outlined\"\r\n        onClick={() => {\r\n          navigatorGeolocation();\r\n        }}\r\n      >\r\n       Включите геолокацию для максимально точного поиска\r\n      </Button>\r\n      <Button\r\n        style={{\r\n          backgroundColor: \"black\",\r\n          color: \"white\",\r\n          padding: 10,\r\n          margin: 10,\r\n          alignItems: \"center\",\r\n          cursor: \"pointer\",\r\n        }}\r\n        disabled={open}\r\n        variant=\"outlined\"\r\n        onClick={() => {\r\n          handleDrawerLeftOpen();\r\n        }}\r\n      >\r\n        Оставить заявку для всех\r\n      </Button>\r\n      <Button\r\n        style={{\r\n          backgroundColor: \"rgb(85 255 42)\",\r\n          color: \"black\",\r\n          padding: 10,\r\n          margin: 10,\r\n          alignItems: \"center\",\r\n          cursor: \"pointer\",\r\n        }}\r\n        disabled={open}\r\n        variant=\"outlined\"\r\n        onClick={() => {\r\n          handleMapOpen();\r\n        }}\r\n      >\r\n        Показать на карте\r\n      </Button>\r\n    </div>\r\n  );\r\n  // console.log('instance55555555', instanceRef);\r\n  //\tconsole.log(distance); //  /routename\r\n  // getRoute();\r\n  // localStorage.setItem(\"lng\", data);\r\n};\r\nexport default DestinationSearch;\r\n","import React, { useState, useEffect, memo, useRef, Suspense } from \"react\";\nimport Sidebar from \"./Sidebar\";\nimport Chat from \"./Chat\";\nimport Login from \"./Login\";\nimport setOnlineStatus from \"./setOnlineStatus\";\nimport { Route, useLocation, Redirect } from \"react-router-dom\";\nimport { useStateValue } from \"./StateProvider\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport db, { auth, provider, createTimestamp, messaging } from \"./firebase\";\nimport {\n  TransitionGroup,\n  Transition,\n  CSSTransition,\n} from \"react-transition-group\";\nimport \"./App.css\";\nimport useRoomsData from \"./useRoomsData\";\nimport scalePage from \"./scalePage\";\nimport useFetchData from \"./useFetchData.js\";\nimport DestinationSearch from \"./DestinationSearch\";\n//const DestinationSearch = React.lazy(() => import(\"./DestinationSearch\"));\nlocalStorage.setItem(\"gps\", \"47.6758555, 38.0625965\");\nlocalStorage.setItem(\"gps_sum\", \"85.6\");\nlocalStorage.setItem(\"lng\", \"38.0625965\");\nlocalStorage.setItem(\"lat\", \"47.6758555\");\n\nnavigator.geolocation.getCurrentPosition(function (position) {\n  // Текущие координаты.\n  var lat = position.coords.latitude;\n  var lng = position.coords.longitude;\n  var gpska = lat + \", \" + lng;\n  var gps_suma = lat + lng;\n\n  localStorage.setItem(\"lat\", lat);\n  localStorage.setItem(\"lng\", lng);\n  localStorage.setItem(\"gps\", gpska);\n  localStorage.setItem(\"gps_sum\", gps_suma);\n  let accuracy = position.coords.accuracy;\n  localStorage.setItem(\"accuracy\", accuracy);\n  //console.log(\"lat доступна \" + lat); // Геолокация доступна\n  //console.log(\"lng доступна \" + lng); // Геолокация доступна\n  //console.log(\"accuracy доступна \" + accuracy); // Погрешность\n  // console.log(\"Cумма координат \" + gps_suma); // Погрешность\n  //\t  setGps_sum(gps_suma);\n  //  setGps_ka(gpska);\n});\n\nconst configureNotif = (docID) => {\n  messaging\n    .requestPermission()\n    .then(() => {\n      //console.log('permission granted');\n      return messaging.getToken();\n    })\n    .then((token) => {\n      //console.log(token);\n      db.collection(\"users\").doc(docID).set(\n        {\n          token: token,\n        },\n        { merge: true }\n      );\n    })\n    .catch((e) => {\n      //console.log(e.message);\n      db.collection(\"users\").doc(docID).set(\n        {\n          token: \"\",\n        },\n        { merge: true }\n      );\n    });\n};\n\nfunction App() {\n  const [{ user, path, pathID, roomsData, page }, dispatch, actionTypes] =\n    useStateValue();\n  const [loader, setLoader] = useState(true);\n  const [pwaEvent, setPwaEvent] = useState(undefined);\n  const [updating, setUpdating] = useState(false);\n  const [checkingVersion, setCheckingVerison] = useState(true); \n\n  const [openMap, setOpenMap] = useState(false); \n\n  const [chats, setChats] = useState(null);\n  const [chatsFetched, setChatsFetched] = useState();\n  const location = useLocation();\n  const [setRoomsData] = useRoomsData();\n  const b = useRef([]);\n  const menus = [\"/rooms\", \"/search\", \"/users\", \"/chats\"];\n\n  const [rooms, fetchRooms] = useFetchData(\n    30,\n    db.collection(\"rooms\").orderBy(\"timestamp\", \"desc\"),\n    true,\n    (snap) => {\n      return snap.docs.map((doc) => ({\n        id: doc.id,\n        ...doc.data(),\n      }));\n    },\n    \"rooms\"\n  );\n\n  const [users, fetchUsers] = useFetchData(\n    30,\n    db\n      .collection(\"users\")\n      // .orderBy(\"coord_sum\", \"desc\")\n      //.find({coord_sum: \"85.7360078\"})\n   //   .where('coord_sum', '==',  localStorage.getItem(\"gps_sum\").substring(4, -4))\n       .where('state', '==',  'online')\n      ,\n    /*  .where({\n        coord_sum: localStorage.getItem(\"gps_sum\").substring(4, -4),\n        state: 'online'\n      }),*/\n    // .orderBy(\"timestamp\", \"desc\")\n    //.where('coord_sum',\n    //  .isEqualTo(\"85.7360078\")\n    //.where('role', '==', 'Пассажир')\n    // db.collection(\"users\").orderBy(\"timestamp\", \"desc\").where('role', '==', 'Пассажир'),\n    true,\n    (snap) => {\n      const data = [];\n      if (snap.docs.length > 0) {\n        snap.docs.forEach((doc) => {\n          const id = doc.id > user.uid ? doc.id + user.uid : user.uid + doc.id;\n          if (doc.id !== user.uid) {\n            data.push({\n              ...doc.data(),\n              id,\n              userID: doc.id,\n            });\n            setRoomsData(doc.id, id);\n          }\n        });\n      }\n      return data;\n    },\n    \"users\"\n  );\n  console.log(users);\n  useEffect(() => {\n    auth.onAuthStateChanged((authUser) => {\n      //console.log(\"user change: \", authUser)\n      if (authUser) {\n        dispatch({ type: actionTypes.SET_USER, user: authUser });\n        setLoader(false);\n        if (\"serviceWorker\" in navigator && \"PushManager\" in window) {\n          //console.log(\"This browser supports notifications and service workers\")\n          configureNotif(authUser.uid);\n        }\n        //console.log(authUser);\n        /*    db.collection(\"version\").doc(\"version\").get().then(doc => {\n          const version = doc.data().version;\n          const previousVersion = localStorage.getItem(\"version\");\n          if (previousVersion) {\n            //console.log(\"previous version exists in local storage\")\n            if (version !== +previousVersion) {\n              //console.log(\"new version is not equal to previous version\")\n              localStorage.setItem(\"version\", version);\n              setUpdating(true);\n              auth.signOut();\n              auth.signInWithRedirect(provider).catch(e => alert(e.message))\n            } else {\n              setCheckingVerison(false)\n            }\n          } else {\n            //console.log(\"previous version doesn't exists in local storage\")\n            localStorage.setItem(\"version\", version);\n            setCheckingVerison(false)\n          }\n        });*/\n        const ref = db.collection(\"users\").doc(authUser.uid);\n        ref.get().then((doc) => {\n          const data = doc.data();\n          if (data) {\n            if (data.timestamp) {\n              //console.log(\"updating user\")\n              return ref.set(\n                {\n                  name: authUser.displayName,\n                  photoURL: authUser.photoURL,\n               //   about: \"\",\n               //   phone: \"\",\n                  role: localStorage.getItem(\"role\"),\n                  searchrole: localStorage.getItem(\"searchrole\"),\n                },\n                { merge: true }\n              );\n            }\n          }\n          //console.log(\"setting user\")\n          return ref.set(\n            {\n              name: authUser.displayName,\n              photoURL: authUser.photoURL,\n              timestamp: createTimestamp(),\n           //   about: \"\",\n            //  phone: \"\",\n              role: localStorage.getItem(\"role\"),\n              searchrole: localStorage.getItem(\"searchrole\"),\n            },\n            { merge: true }\n          );\n        });\n      } else {\n        dispatch({ type: actionTypes.SET_USER, user: null });\n        //console.log(user);\n        /*  setLoader(false);\n        db.collection(\"version\").doc(\"version\").get().then(doc => {\n          const version = doc.data().version;\n          const previousVersion = localStorage.getItem(\"version\");\n          if (previousVersion) {\n            //console.log(\"previous version exists in local storage\")\n            if (version !== +previousVersion) {\n              //console.log(\"new version is not equal to previous version\")\n              localStorage.setItem(\"version\", version);\n              setCheckingVerison(false)\n            } else {\n              setCheckingVerison(false)\n            }\n          } else {\n            //console.log(\"previous version doesn't exists in local storage\")\n            localStorage.setItem(\"version\", version);\n            setCheckingVerison(false)\n          }\n        })*/\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    window.addEventListener(\"beforeinstallprompt\", (e) => {\n      // Prevent the mini-infobar from appearing on mobile\n      //console.log(\"pwa event executed\");\n      e.preventDefault();\n      // Stash the event so it can be triggered later.\n      setPwaEvent(e);\n      // Update UI notify the user they can install the PWA\n    });\n    window.addEventListener(\"resize\", () => {\n      dispatch({ type: \"set_scale_page\", page: scalePage() });\n    });\n  }, []);\n\n  useEffect(() => {\n    if (user) {\n      db.collection(\"users\")\n        .doc(user.uid)\n        .collection(\"chats\")\n        .orderBy(\"timestamp\", \"desc\")\n        .onSnapshot({ includeMetadataChanges: true }, (snap) => {\n          if (snap.docs?.length > 0) {\n            snap.docChanges().forEach((change) => {\n              if (change.type === \"added\") {\n                setRoomsData(change.doc.data().userID, change.doc.id);\n              }\n            });\n            if (\n              !snap.metadata.fromCache ||\n              (!window.navigator.onLine && snap.metadata.fromCache)\n            ) {\n              setChats(\n                snap.docs.map((cur) => ({\n                  ...cur.data(),\n                  id: cur.id,\n                }))\n              );\n            }\n          } else {\n            setChats([]);\n          }\n        });\n      fetchRooms(() => null);\n      fetchUsers(() => null);\n    }\n  }, [user]);\n\n  useEffect(() => {\n    if (chats?.length > 0) {\n      if (chats.every((cur) => roomsData[cur.id]?.lastMessage)) {\n        setChatsFetched(true);\n      }\n    } else if (chats?.length === 0) {\n      setChatsFetched(true);\n    }\n  }, [chats, roomsData]);\n\n  useEffect(() => {\n    var s;\n    if (user) {\n      setOnlineStatus(user.uid);\n    }\n    return () => {\n      if (s) {\n        s();\n      }\n    };\n  }, [user]);\n\n  useEffect(() => {\n    var id = location.pathname.replace(\"/room/\", \"\");\n    menus.forEach((cur) => (id = id.replace(cur, \"\")));\n    dispatch({ type: \"set_path_id\", id });\n  }, [location.pathname]);\n\n  return (\n    <div className=\"app\">\n      {page.width <= 160 ? <Redirect to=\"/chats\" /> : <Redirect to=\"/\" />}\n      {!user && loader && !updating ? (\n        <Login />\n      ) : user && !updating && chatsFetched ? (\n        <div className=\"app__body\">\n          <Sidebar\n            chats={chats}\n            pwa={pwaEvent}\n            rooms={rooms}\n            fetchRooms={fetchRooms}\n            users={users}\n            fetchUsers={fetchUsers}\n          />\n        \n\n          <TransitionGroup component={null}> \n          \n        \n            <DestinationSearch open={openMap}  users={users} fetchUsers={fetchUsers} />\n          \n\n\n            {page.width <= 760 ? (\n              <Transition\n                key={location.pathname.replace(\"/image\", \"\")}\n                timeout={260}\n              >\n                {(state) => (\n                  <Route location={location} path={`${path}/room/:roomID`}> \n                    <Chat\n                      b={b}\n                      unreadMessages={\n                        chats?.length > 0\n                          ? chats.find((cur) => cur.id === pathID)\n                              ?.unreadMessages\n                          : 0\n                      }\n                      animState={state}\n                    />\n                  </Route>\n                )}\n              </Transition>\n            ) : (\n              <CSSTransition\n                key={location.pathname.replace(\"/image\", \"\")}\n                timeout={1010}\n                classNames=\"page\"\n              >\n                {(state) => (\n                  <Route location={location} path={`${path}/room/:roomID`}>\n                    <Chat\n                      b={b}\n                      unreadMessages={\n                        chats?.length > 0\n                          ? chats.find((cur) => cur.id === pathID)\n                              ?.unreadMessages\n                          : 0\n                      }\n                      animState={state}\n                    />\n                  </Route>\n                )}\n              </CSSTransition>\n            )}\n          </TransitionGroup>\n        </div>\n      ) : (\n        <div className=\"loader__container\">\n          <CircularProgress />\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default memo(App);\n","import {useEffect, useRef} from \"react\";\nimport { useStateValue } from \"./StateProvider\";\nimport db from \"./firebase\";\n\nexport default function useRoomsData() {\n    const [{ roomsData: initRoomsData }, dispatch] = useStateValue();\n    const roomsData = useRef(initRoomsData)\n\n    useEffect(() => {\n        roomsData.current = initRoomsData;\n    }, [initRoomsData])\n    \n    return [function setRoomsData(userID, roomID) {\n        if (!roomsData.current[roomID]) {\n            const lastMessageListener = db.collection(\"rooms\").doc(roomID).onSnapshot(doc => {\n                //console.log(\"last message listener executed with room id: \", roomID)\n                dispatch({\n                    type: \"update_rooms_data\",\n                    dataType: \"lastMessage\",\n                    data: doc.data()?.lastMessage,\n                    roomID\n                });\n            });\n            const onlineStateListener = db.collection(\"users\").doc(userID).onSnapshot(doc => {\n                //console.log(\"onlineState listener executed with room id: \", roomID)\n                dispatch({\n                    type: \"update_rooms_data\",\n                    dataType: \"onlineState\",\n                    data: doc.data()?.state,\n                    roomID\n                });\n            });\n            dispatch({\n                type: \"add_rooms_data\",\n                roomID,\n                lastMessageListener: lastMessageListener,\n                onlineStatelistener: onlineStateListener \n            });\n        };\n    }];\n};","import db, { createTimestamp, createTimestamp2, db2 } from \"./firebase\";\n\nexport default function setOnlineStatus(uid) {\n  try {\n    //const [gps_sum, setGps_sum] = useState(null);\n    //\tconst [gps, setGps_ka] = useState(null);\n  console.log( localStorage.getItem(\"gps_sum\").substring(4, -4));\n  console.log( localStorage.getItem(\"gps_sum\"));\n    const isOfflineForDatabase = {\n      state: \"offline\",\n      last_changed: createTimestamp2,\n      id: uid,\n      latitude: localStorage.getItem(\"lat\"),\n      longitude: localStorage.getItem(\"lng\"),\n      coord: localStorage.getItem(\"gps\"),\n      coord_sum: localStorage.getItem(\"gps_sum\").substring(4, -4),\n      role:localStorage.getItem(\"role\"),\n      searchrole:localStorage.getItem(\"searchrole\"),\n    \n    };\n\n    const isOnlineForDatabase = {\n      state: \"online\",\n      last_changed: createTimestamp2,\n      id: uid,\n      latitude: localStorage.getItem(\"lat\"),\n      longitude: localStorage.getItem(\"lng\"),\n      coord: localStorage.getItem(\"gps\"),\n      coord_sum: localStorage.getItem(\"gps_sum\").substring(4, -4),\n      role:localStorage.getItem(\"role\"),\n      searchrole:localStorage.getItem(\"searchrole\"),\n    };\n    const userStatusFirestoreRef = db.doc(\"/users/\" + uid);\n    const userStatusDatabaseRef = db2.ref(\"/status/\" + uid);\n\n    // Firestore uses a different server timestamp value, so we'll\n    // create two more constants for Firestore state.\n    const isOfflineForFirestore = {\n      state: \"offline\",\n      last_changed: createTimestamp(),\n      latitude: localStorage.getItem(\"lat\"),\n      longitude: localStorage.getItem(\"lng\"),\n      coord: localStorage.getItem(\"gps\"),\n      coord_sum: localStorage.getItem(\"gps_sum\").substring(4, -4),\n      role:localStorage.getItem(\"role\"),\n      searchrole:localStorage.getItem(\"searchrole\"),\n    };\n\n    const isOnlineForFirestore = {\n      state: \"online\",\n      last_changed: createTimestamp(),\n      latitude: localStorage.getItem(\"lat\"),\n      longitude: localStorage.getItem(\"lng\"),\n      coord: localStorage.getItem(\"gps\"),\n      coord_sum: localStorage.getItem(\"gps_sum\").substring(4, -4),\n      role:localStorage.getItem(\"role\"),\n      searchrole:localStorage.getItem(\"searchrole\"),\n    };\n\n    db2.ref(\".info/connected\").on(\"value\", function (snapshot) {\n      if (snapshot.val() === false) {\n        // Instead of simply returning, we'll also set Firestore's state\n        // to 'offline'. This ensures that our Firestore cache is aware\n        // of the switch to 'offline.'\n        userStatusFirestoreRef.set(isOfflineForFirestore, { merge: true });\n        return;\n      }\n\n      userStatusDatabaseRef\n        .onDisconnect()\n        .set(isOfflineForDatabase)\n        .then(function () {\n          userStatusDatabaseRef.set(isOnlineForDatabase);\n\n          // We'll also add Firestore set here for when we come online.\n          userStatusFirestoreRef.set(isOnlineForFirestore, { merge: true });\n        });\n    });\n  } catch (error) {\n    console.log(\"error setting onlins status: \", error);\n  }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration';\nimport { StateProvider } from './StateProvider';\nimport reducer, { initialState } from \"./reducer\"\nimport { BrowserRouter as Router } from \"react-router-dom\"\n\nif (navigator.mediaDevices === undefined) {\n  navigator.mediaDevices = {};\n}\nif (navigator.mediaDevices.getUserMedia === undefined) {\n  navigator.mediaDevices.getUserMedia = function(constraints) {\n    var getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\n    if (!getUserMedia) {\n      return Promise.reject(new Error('getUserMedia is not implemented in this browser'));\n    }\n    return new Promise(function(resolve, reject) {\n      getUserMedia.call(navigator, constraints, resolve, reject);\n    });\n  }\n}\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <Router>\n      <StateProvider initialState={initialState} reducer={reducer}>\n        <App />\n      </StateProvider>\n    </Router>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://cra.link/PWA\nserviceWorkerRegistration.register();\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n//reportWebVitals();\n"],"sourceRoot":""}